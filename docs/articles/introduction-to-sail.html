<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the sail package • sail</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the sail package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sail</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction-to-sail.html">Introduction to sail</a>
    </li>
    <li>
      <a href="../articles/user-defined-design.html">User defined design matrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sahirbhatnagar/sail">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to the sail package</h1>
                        <h4 class="author">Sahir Rai Bhatnagar</h4>
            
            <h4 class="date">2018-04-15</h4>
      
      <small>Source: <a href="https://github.com/sahirbhatnagar/sail/blob/master/vignettes/introduction-to-sail.Rmd"><code>vignettes/introduction-to-sail.Rmd</code></a></small>
      <div class="hidden name"><code>introduction-to-sail.Rmd</code></div>

    </div>

    
    
<p><code>sail</code> is a package that fits a linear model with non-linear interactions via penalized maximum likelihood. The regularization path is computed at a grid of values for the regularization parameter <span class="math inline">\(\lambda\)</span> and a fixed value of the second regularization parameter <span class="math inline">\(\alpha\)</span>. The method enforces the strong heredity property, i.e., an interaction is selected only if its corresponding main effects are also included. The interactions are limited to a single exposure variable, i.e., <span class="math inline">\(y \sim e + x_1 + x_2 + e*x_1 + e*x_2 + \epsilon\)</span>. Furthermore, this package allows a user-defined basis expansion on the <span class="math inline">\(x\)</span> variables to allow for non-linear effects. The default is bsplines (e.g. <code><a href="http://www.rdocumentation.org/packages/splines/topics/bs">splines::bs(x, 5)</a></code>). It currently only fits linear models (binomial models are due in the next release).</p>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
Let <span class="math inline">\(Y=(Y_1, \ldots, Y_n) \in \mathbb{R}^n\)</span> be a continuous outcome variable,  a binary or continuous environment vector,  a matrix of predictors, and <span class="math inline">\(\varepsilon = (\varepsilon_1, \ldots, \varepsilon_n) \in \mathbb{R}^n\)</span> a vector of i.i.d random variables with mean 0. Furthermore let <span class="math inline">\(f_j: \mathbb{R} \rightarrow \mathbb{R}\)</span> be a smoothing method for variable <span class="math inline">\(X_j\)</span> by a projection on to a set of basis functions:
<span class="math display">\[\begin{equation}
f_j(X_j) = \sum_{\ell = 1}^{m_j} \psi_{j\ell}(X_j) \beta_{j\ell} \label{eq:smooth}
\end{equation}\]</span>
Here, the <span class="math inline">\(\left\lbrace \psi_{j\ell} \right\rbrace_1^{m_j}\)</span> are a family of basis functions in <span class="math inline">\(X_j\)</span>~. Let <span class="math inline">\(\boldsymbol{\Psi}_j\)</span> be the <span class="math inline">\(n \times m_j\)</span> matrix of evaluations of the <span class="math inline">\(\psi_{j\ell}\)</span> and  for <span class="math inline">\(j = 1, \ldots, p\)</span>, i.e., <span class="math inline">\(\boldsymbol{\theta}_j\)</span> is a <span class="math inline">\(m_j\)</span>-dimensional column vector of basis coefficients for the <span class="math inline">\(j\)</span>th main effect. In this article we consider an additive interaction regression model of the form
<span class="math display">\[\begin{align}
Y  &amp; =  \beta_0 \cdot \boldsymbol{1} + \sum_{j=1}^p \boldsymbol{\Psi}_j \boldsymbol{\theta}_j + \beta_E X_E + \sum_{j=1}^p (X_E \circ \boldsymbol{\Psi}_j) \boldsymbol{\alpha}_{j}  + \varepsilon  \label{eq:linpred}
\end{align}\]</span>
where <span class="math inline">\(\beta_0\)</span> is the intercept, <span class="math inline">\(\beta_E\)</span> is the coefficient for the environment variable, <span class="math inline">\(\boldsymbol{\alpha}_j = (\alpha_{j1}, \ldots, \alpha_{jm_j})\in \mathbb{R}^{m_j}\)</span> are the basis coefficients for the <span class="math inline">\(j\)</span>th interaction term and <span class="math inline">\((X_E \circ \boldsymbol{\Psi}_j)\)</span> is the <span class="math inline">\(n \times m_j\)</span> matrix formed by the component-wise multiplication of the column vector <span class="math inline">\(X_E\)</span> by each column of <span class="math inline">\(\boldsymbol{\Psi}_j\)</span>. To enforce the strong heredity property, we reparametrize the coefficients for the interaction terms in~ as <span class="math inline">\(\boldsymbol{\alpha}_{j} = \gamma_{j} \beta_E \boldsymbol{\theta}_j\)</span>:
<span class="math display">\[\begin{align}
Y  &amp; =  \beta_0 \cdot \boldsymbol{1} + \sum_{j=1}^p \boldsymbol{\Psi}_j \boldsymbol{\theta}_j + \beta_E X_E + \sum_{j=1}^p \gamma_{j}  \beta_E (X_E \circ \boldsymbol{\Psi}_j) \boldsymbol{\theta}_j + \varepsilon   \label{eq:linpred2}
\end{align}\]</span>
For a continuous response, we use the squared-error loss:
<span class="math display">\[\begin{equation}
\mathcal{L}(Y;\boldsymbol{\theta}) = \frac{1}{2n}\lVert Y - \beta_0 \cdot \boldsymbol{1} - \sum_{j=1}^p \boldsymbol{\Psi}_j \boldsymbol{\theta}_j - \beta_E X_E - \sum_{j=1}^p \gamma_{j}  \beta_E (X_E \circ \boldsymbol{\Psi}_j) \boldsymbol{\theta}_j \rVert_2^2
\end{equation}\]</span>
<p>where <span class="math inline">\(\boldsymbol{\theta} \equiv (\beta_0, \beta_E,\boldsymbol{\theta}_1, \ldots, \boldsymbol{\theta}_p, \gamma_1, \ldots, \gamma_p)\)</span>.</p>
We consider the following penalized least squares criterion for this problem:
<span class="math display">\[\begin{equation}
\arg\min_{\boldsymbol{\theta} }  \mathcal{L}(Y;\boldsymbol{\theta}) + \lambda (1-\alpha)  \left( w_E |\beta_E| + \sum_{j=1}^{p} w_j \lVert\boldsymbol{\theta}_j \rVert_2 \right) +  \lambda\alpha \sum_{j=1}^{p} w_{jE} |\gamma_{j}| \label{eq:lassolikelihood3}
\end{equation}\]</span>
<p>where <span class="math inline">\(\lambda &gt;0\)</span> and <span class="math inline">\(\alpha \in (0,1)\)</span> are tuning parameters and <span class="math inline">\(w_E, w_j, w_{jE}\)</span> are adaptive weights for <span class="math inline">\(j=1, \ldots, p\)</span>. These weights serve as a way of allowing parameters to be penalized differently.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The package can be installed from <a href="https://github.com/sahirbhatnagar/sail">GitHub</a> via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"pacman"</span>)
pacman<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pacman/topics/p_load_gh">p_load_gh</a></span>(<span class="st">'sahirbhatnagar/sail'</span>)</code></pre></div>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>We give a quick overview of the main functions and go into details in other vignettes. We will use the simulated data which ships with the package and can be loaded via:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sail)
<span class="kw">data</span>(<span class="st">"sailsim"</span>)
<span class="kw">names</span>(sailsim)
<span class="co">#&gt; [1] "x"        "y"        "e"        "f1"       "f2"       "f3"      </span>
<span class="co">#&gt; [7] "f4"       "f3.inter" "f4.inter"</span></code></pre></div>
<p>We first define a basis expansion. In this example we use cubic bsplines with degree 5.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(splines)
f.basis &lt;-<span class="st"> </span><span class="cf">function</span>(x) splines<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/splines/topics/bs">bs</a></span>(x, <span class="dt">degree =</span> <span class="dv">5</span>)</code></pre></div>
<p>Next we fit the model using the most basic call to <code>sail</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sail.html">sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e, <span class="dt">basis =</span> f.basis,
            <span class="dt">verbose =</span> <span class="dv">0</span>)</code></pre></div>
<p><code>fit</code> is an object of class <code>sail</code> that contains all the relevant information of the fitted model including the estimated coefficients at each value of <span class="math inline">\(\lambda\)</span> (by default the program chooses its own decreasing sequence of 100 <span class="math inline">\(\lambda\)</span> values). There are <code>print</code>, <code>plot</code>, <code>coef</code> and <code>predict</code> methods of objects of class <code>sail</code>. The <code>print</code> method outputs the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  sail(x = sailsim$x, y = sailsim$y, e = sailsim$e, basis = f.basis,      verbose = 0) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      df_main df_interaction df_environment     %Dev  Lambda</span>
<span class="co">#&gt; s1         0              0              0 0.000000 1.41800</span>
<span class="co">#&gt; s2         0              0              1 0.001371 1.35400</span>
<span class="co">#&gt; s3         0              0              1 0.002711 1.29200</span>
<span class="co">#&gt; s4         0              0              1 0.003955 1.23400</span>
<span class="co">#&gt; s5         2              0              1 0.025520 1.17800</span>
<span class="co">#&gt; s6         2              0              1 0.057640 1.12400</span>
<span class="co">#&gt; s7         2              0              1 0.087540 1.07300</span>
<span class="co">#&gt; s8         2              0              1 0.115400 1.02400</span>
<span class="co">#&gt; s9         2              0              1 0.141200 0.97760</span>
<span class="co">#&gt; s10        2              0              1 0.165200 0.93320</span>
<span class="co">#&gt; s11        2              0              1 0.187500 0.89080</span>
<span class="co">#&gt; s12        2              0              1 0.208200 0.85030</span>
<span class="co">#&gt; s13        2              0              1 0.227400 0.81170</span>
<span class="co">#&gt; s14        3              0              1 0.246800 0.77480</span>
<span class="co">#&gt; s15        3              0              1 0.266000 0.73950</span>
<span class="co">#&gt; s16        3              0              1 0.283600 0.70590</span>
<span class="co">#&gt; s17        3              1              1 0.436200 0.67380</span>
<span class="co">#&gt; s18        3              1              1 0.447100 0.64320</span>
<span class="co">#&gt; s19        3              1              1 0.457900 0.61400</span>
<span class="co">#&gt; s20        4              2              1 0.471600 0.58610</span>
<span class="co">#&gt; s21        4              2              1 0.484000 0.55940</span>
<span class="co">#&gt; s22        4              2              1 0.495500 0.53400</span>
<span class="co">#&gt; s23        5              2              1 0.505800 0.50970</span>
<span class="co">#&gt; s24        5              2              1 0.516700 0.48660</span>
<span class="co">#&gt; s25        5              2              1 0.526800 0.46450</span>
<span class="co">#&gt; s26        5              2              1 0.536100 0.44330</span>
<span class="co">#&gt; s27        5              2              1 0.544700 0.42320</span>
<span class="co">#&gt; s28        5              3              1 0.555100 0.40400</span>
<span class="co">#&gt; s29        5              3              1 0.563600 0.38560</span>
<span class="co">#&gt; s30        5              3              1 0.571500 0.36810</span>
<span class="co">#&gt; s31        7              3              1 0.581700 0.35130</span>
<span class="co">#&gt; s32        7              3              1 0.592200 0.33540</span>
<span class="co">#&gt; s33        7              3              1 0.603100 0.32010</span>
<span class="co">#&gt; s34        7              3              1 0.611500 0.30560</span>
<span class="co">#&gt; s35        7              3              1 0.619500 0.29170</span>
<span class="co">#&gt; s36        7              3              1 0.627000 0.27840</span>
<span class="co">#&gt; s37        7              3              1 0.634800 0.26580</span>
<span class="co">#&gt; s38        7              4              1 0.681800 0.25370</span>
<span class="co">#&gt; s39        7              4              1 0.688200 0.24220</span>
<span class="co">#&gt; s40        7              4              1 0.694200 0.23120</span>
<span class="co">#&gt; s41        7              4              1 0.700200 0.22070</span>
<span class="co">#&gt; s42        7              6              1 0.705400 0.21060</span>
<span class="co">#&gt; s43        7              6              1 0.711800 0.20110</span>
<span class="co">#&gt; s44        7              6              1 0.716800 0.19190</span>
<span class="co">#&gt; s45        9              6              1 0.721700 0.18320</span>
<span class="co">#&gt; s46       10              6              1 0.727100 0.17490</span>
<span class="co">#&gt; s47       11              6              1 0.732300 0.16690</span>
<span class="co">#&gt; s48       12              6              1 0.738400 0.15930</span>
<span class="co">#&gt; s49       12              6              1 0.744300 0.15210</span>
<span class="co">#&gt; s50       12              6              1 0.749900 0.14520</span>
<span class="co">#&gt; s51       14              6              1 0.755700 0.13860</span>
<span class="co">#&gt; s52       15              6              1 0.761700 0.13230</span>
<span class="co">#&gt; s53       15              6              1 0.768000 0.12630</span>
<span class="co">#&gt; s54       16              7              1 0.774700 0.12050</span>
<span class="co">#&gt; s55       13             11              1 0.830100 0.11500</span>
<span class="co">#&gt; s56       13             11              1 0.833400 0.10980</span>
<span class="co">#&gt; s57       13             11              1 0.836800 0.10480</span>
<span class="co">#&gt; s58       14             11              1 0.840000 0.10010</span>
<span class="co">#&gt; s59       14             11              1 0.843300 0.09552</span>
<span class="co">#&gt; s60       14             11              1 0.846400 0.09117</span>
<span class="co">#&gt; s61       16             13              1 0.899100 0.08703</span>
<span class="co">#&gt; s62       16             13              1 0.901600 0.08308</span>
<span class="co">#&gt; s63       16             12              1 0.905100 0.07930</span>
<span class="co">#&gt; s64       16             13              1 0.907500 0.07569</span>
<span class="co">#&gt; s65       16             13              1 0.910700 0.07225</span>
<span class="co">#&gt; s66       16             14              1 0.913400 0.06897</span>
<span class="co">#&gt; s67       16             14              1 0.916100 0.06584</span>
<span class="co">#&gt; s68       16             14              1 0.918600 0.06284</span>
<span class="co">#&gt; s69       17             14              1 0.921200 0.05999</span>
<span class="co">#&gt; s70       17             13              1 0.923700 0.05726</span>
<span class="co">#&gt; s71       17             13              1 0.926200 0.05466</span>
<span class="co">#&gt; s72       17             13              1 0.928600 0.05217</span>
<span class="co">#&gt; s73       18             13              1 0.930900 0.04980</span>
<span class="co">#&gt; s74       18             13              1 0.933100 0.04754</span>
<span class="co">#&gt; s75       18             13              1 0.935300 0.04538</span>
<span class="co">#&gt; s76       19             13              1 0.937400 0.04332</span>
<span class="co">#&gt; s77       19             15              1 0.945000 0.04135</span>
<span class="co">#&gt; s78       20             16              1 0.946700 0.03947</span>
<span class="co">#&gt; s79       20             16              1 0.948500 0.03767</span>
<span class="co">#&gt; s80       20             16              1 0.950500 0.03596</span>
<span class="co">#&gt; s81       20             16              1 0.952300 0.03433</span>
<span class="co">#&gt; s82       20             18              1 0.957300 0.03277</span>
<span class="co">#&gt; s83       20             18              1 0.958200 0.03128</span>
<span class="co">#&gt; s84       20             18              1 0.959300 0.02986</span>
<span class="co">#&gt; s85       20             18              1 0.960400 0.02850</span>
<span class="co">#&gt; s86       20             18              1 0.961600 0.02720</span>
<span class="co">#&gt; s87       20             18              1 0.962700 0.02597</span>
<span class="co">#&gt; s88       20             18              1 0.963900 0.02479</span>
<span class="co">#&gt; s89       20             18              1 0.964900 0.02366</span>
<span class="co">#&gt; s90       20             18              1 0.966000 0.02258</span>
<span class="co">#&gt; s91       20             19              1 0.967000 0.02156</span>
<span class="co">#&gt; s92       20             19              1 0.969400 0.02058</span>
<span class="co">#&gt; s93       20             19              1 0.970300 0.01964</span>
<span class="co">#&gt; s94       20             19              1 0.971900 0.01875</span>
<span class="co">#&gt; s95       20             19              1 0.972600 0.01790</span>
<span class="co">#&gt; s96       20             19              1 0.973500 0.01708</span>
<span class="co">#&gt; s97       20             19              1 0.974200 0.01631</span>
<span class="co">#&gt; s98       20             19              1 0.975000 0.01557</span>
<span class="co">#&gt; s99       20             19              1 0.975800 0.01486</span>
<span class="co">#&gt; s100      20             20              1 0.976500 0.01418</span></code></pre></div>
<p>When <code>expand = TRUE</code> (i.e. the user did not provide their own design matrix), the <code>df_main</code> and <code>df_interaction</code> columns correspond to the number of non-zero predictors present in the model before basis expansion. This <strong>does not</strong> correspond to the number of non-zero coefficients in the model, but rather the number of unique variables. In this example we expanded each column of <span class="math inline">\(\mathbf{X}\)</span> to five columns. If <code>df_main=4</code>, <code>df_interaction=2</code> and <code>df_environment=1</code>, then the total number of non-zero coefficients would be <span class="math inline">\(5 \times (4+2) + 1\)</span>.</p>
<p>The entire solution path can be plotted via the <code>plot</code> method for objects of class <code>sail</code>. The y-axis is the value of the coefficient and the x-axis is the <span class="math inline">\(\log(\lambda)\)</span>. Each line represents a coefficient in the model, and each color represents a variable (i.e. in this example a given variable will have 5 lines when it is non-zero). The numbers at the top of the plot represent the number of non-zero variables in the model: top panel (<code>df_main</code> + <code>df_environment</code>), bottom panel (<code>df_interaction</code>). The black line is the coefficient path for the environment variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fit)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The estimated coefficients at each value of lambda is given by (matrix partially printed here for brevity)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt; 5 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                   s1       s2      s3       s4       s5</span>
<span class="co">#&gt; (Intercept) 5.328505 5.332607 5.33666 5.340466 5.344098</span>
<span class="co">#&gt; X1_1        .        .        .       .        .       </span>
<span class="co">#&gt; X1_2        .        .        .       .        .       </span>
<span class="co">#&gt; X1_3        .        .        .       .        .       </span>
<span class="co">#&gt; X1_4        .        .        .       .        .</span></code></pre></div>
<p>The predicted response at each value of lambda:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;            s1       s2       s3       s4       s5</span>
<span class="co">#&gt; [1,] 5.328505 5.312344 5.296375 5.281383 5.305822</span>
<span class="co">#&gt; [2,] 5.328505 5.317729 5.307080 5.297083 5.352881</span>
<span class="co">#&gt; [3,] 5.328505 5.352655 5.376516 5.398919 5.280278</span>
<span class="co">#&gt; [4,] 5.328505 5.363960 5.398991 5.431881 5.613893</span>
<span class="co">#&gt; [5,] 5.328505 5.317676 5.306976 5.296930 5.137411</span></code></pre></div>
<p>The predicted response at a specific value of lambda can be specified by the <code>s</code> argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(fit, <span class="dt">s =</span> <span class="fl">0.8</span>)
<span class="co">#&gt;               1</span>
<span class="co">#&gt;   [1,] 5.813009</span>
<span class="co">#&gt;   [2,] 5.021545</span>
<span class="co">#&gt;   [3,] 3.757470</span>
<span class="co">#&gt;   [4,] 6.834599</span>
<span class="co">#&gt;   [5,] 3.057688</span>
<span class="co">#&gt;   [6,] 3.614727</span>
<span class="co">#&gt;   [7,] 6.788465</span>
<span class="co">#&gt;   [8,] 5.174857</span>
<span class="co">#&gt;   [9,] 6.200803</span>
<span class="co">#&gt;  [10,] 5.668292</span>
<span class="co">#&gt;  [11,] 4.871492</span>
<span class="co">#&gt;  [12,] 7.457299</span>
<span class="co">#&gt;  [13,] 7.288454</span>
<span class="co">#&gt;  [14,] 4.713885</span>
<span class="co">#&gt;  [15,] 7.884583</span>
<span class="co">#&gt;  [16,] 4.984439</span>
<span class="co">#&gt;  [17,] 4.223266</span>
<span class="co">#&gt;  [18,] 4.608374</span>
<span class="co">#&gt;  [19,] 4.942420</span>
<span class="co">#&gt;  [20,] 5.787298</span>
<span class="co">#&gt;  [21,] 6.736581</span>
<span class="co">#&gt;  [22,] 5.828758</span>
<span class="co">#&gt;  [23,] 4.592376</span>
<span class="co">#&gt;  [24,] 7.062508</span>
<span class="co">#&gt;  [25,] 4.133018</span>
<span class="co">#&gt;  [26,] 7.260927</span>
<span class="co">#&gt;  [27,] 7.440090</span>
<span class="co">#&gt;  [28,] 3.519319</span>
<span class="co">#&gt;  [29,] 6.933482</span>
<span class="co">#&gt;  [30,] 6.591329</span>
<span class="co">#&gt;  [31,] 5.259667</span>
<span class="co">#&gt;  [32,] 5.334661</span>
<span class="co">#&gt;  [33,] 7.178356</span>
<span class="co">#&gt;  [34,] 4.272326</span>
<span class="co">#&gt;  [35,] 7.803006</span>
<span class="co">#&gt;  [36,] 5.400352</span>
<span class="co">#&gt;  [37,] 5.364526</span>
<span class="co">#&gt;  [38,] 4.375179</span>
<span class="co">#&gt;  [39,] 4.884971</span>
<span class="co">#&gt;  [40,] 5.542767</span>
<span class="co">#&gt;  [41,] 3.537782</span>
<span class="co">#&gt;  [42,] 3.623843</span>
<span class="co">#&gt;  [43,] 5.595137</span>
<span class="co">#&gt;  [44,] 7.719343</span>
<span class="co">#&gt;  [45,] 4.131773</span>
<span class="co">#&gt;  [46,] 4.463181</span>
<span class="co">#&gt;  [47,] 5.476336</span>
<span class="co">#&gt;  [48,] 7.729545</span>
<span class="co">#&gt;  [49,] 4.516719</span>
<span class="co">#&gt;  [50,] 5.339348</span>
<span class="co">#&gt;  [51,] 5.693488</span>
<span class="co">#&gt;  [52,] 4.532031</span>
<span class="co">#&gt;  [53,] 5.582909</span>
<span class="co">#&gt;  [54,] 5.786038</span>
<span class="co">#&gt;  [55,] 4.715549</span>
<span class="co">#&gt;  [56,] 4.362933</span>
<span class="co">#&gt;  [57,] 4.968405</span>
<span class="co">#&gt;  [58,] 5.278855</span>
<span class="co">#&gt;  [59,] 6.975841</span>
<span class="co">#&gt;  [60,] 5.191631</span>
<span class="co">#&gt;  [61,] 4.608410</span>
<span class="co">#&gt;  [62,] 3.085092</span>
<span class="co">#&gt;  [63,] 6.769030</span>
<span class="co">#&gt;  [64,] 4.641189</span>
<span class="co">#&gt;  [65,] 4.702694</span>
<span class="co">#&gt;  [66,] 6.574819</span>
<span class="co">#&gt;  [67,] 5.059686</span>
<span class="co">#&gt;  [68,] 6.325117</span>
<span class="co">#&gt;  [69,] 5.411839</span>
<span class="co">#&gt;  [70,] 7.157186</span>
<span class="co">#&gt;  [71,] 5.001802</span>
<span class="co">#&gt;  [72,] 3.479185</span>
<span class="co">#&gt;  [73,] 5.820304</span>
<span class="co">#&gt;  [74,] 7.282633</span>
<span class="co">#&gt;  [75,] 3.543560</span>
<span class="co">#&gt;  [76,] 4.794373</span>
<span class="co">#&gt;  [77,] 3.413312</span>
<span class="co">#&gt;  [78,] 5.654014</span>
<span class="co">#&gt;  [79,] 5.508392</span>
<span class="co">#&gt;  [80,] 4.913627</span>
<span class="co">#&gt;  [81,] 5.890552</span>
<span class="co">#&gt;  [82,] 6.238446</span>
<span class="co">#&gt;  [83,] 4.983866</span>
<span class="co">#&gt;  [84,] 7.003037</span>
<span class="co">#&gt;  [85,] 5.603688</span>
<span class="co">#&gt;  [86,] 3.619360</span>
<span class="co">#&gt;  [87,] 4.007716</span>
<span class="co">#&gt;  [88,] 4.306506</span>
<span class="co">#&gt;  [89,] 4.241862</span>
<span class="co">#&gt;  [90,] 3.729627</span>
<span class="co">#&gt;  [91,] 5.277631</span>
<span class="co">#&gt;  [92,] 7.316173</span>
<span class="co">#&gt;  [93,] 5.572510</span>
<span class="co">#&gt;  [94,] 6.833482</span>
<span class="co">#&gt;  [95,] 4.800228</span>
<span class="co">#&gt;  [96,] 3.740207</span>
<span class="co">#&gt;  [97,] 5.080186</span>
<span class="co">#&gt;  [98,] 5.049081</span>
<span class="co">#&gt;  [99,] 4.009783</span>
<span class="co">#&gt; [100,] 6.287320</span></code></pre></div>
<p>You can specify more than one value for <code>s</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(fit, <span class="dt">s =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>))
<span class="co">#&gt;               1           2</span>
<span class="co">#&gt;   [1,] 5.813009  6.71855081</span>
<span class="co">#&gt;   [2,] 5.021545  2.65996549</span>
<span class="co">#&gt;   [3,] 3.757470  2.46990229</span>
<span class="co">#&gt;   [4,] 6.834599 15.21267212</span>
<span class="co">#&gt;   [5,] 3.057688  1.78753810</span>
<span class="co">#&gt;   [6,] 3.614727  1.69919001</span>
<span class="co">#&gt;   [7,] 6.788465 13.66404654</span>
<span class="co">#&gt;   [8,] 5.174857  5.88433943</span>
<span class="co">#&gt;   [9,] 6.200803  5.29766673</span>
<span class="co">#&gt;  [10,] 5.668292  4.90230463</span>
<span class="co">#&gt;  [11,] 4.871492  3.80562233</span>
<span class="co">#&gt;  [12,] 7.457299 12.17959186</span>
<span class="co">#&gt;  [13,] 7.288454 12.67153233</span>
<span class="co">#&gt;  [14,] 4.713885  4.17356257</span>
<span class="co">#&gt;  [15,] 7.884583 14.66682102</span>
<span class="co">#&gt;  [16,] 4.984439  4.66356969</span>
<span class="co">#&gt;  [17,] 4.223266  0.30827872</span>
<span class="co">#&gt;  [18,] 4.608374  4.96772027</span>
<span class="co">#&gt;  [19,] 4.942420  3.47297405</span>
<span class="co">#&gt;  [20,] 5.787298  3.59049077</span>
<span class="co">#&gt;  [21,] 6.736581  8.74074489</span>
<span class="co">#&gt;  [22,] 5.828758  5.13636216</span>
<span class="co">#&gt;  [23,] 4.592376  2.06056902</span>
<span class="co">#&gt;  [24,] 7.062508 10.93733791</span>
<span class="co">#&gt;  [25,] 4.133018  0.60343649</span>
<span class="co">#&gt;  [26,] 7.260927  9.26419880</span>
<span class="co">#&gt;  [27,] 7.440090  9.31974444</span>
<span class="co">#&gt;  [28,] 3.519319 -2.21472498</span>
<span class="co">#&gt;  [29,] 6.933482 14.57355630</span>
<span class="co">#&gt;  [30,] 6.591329  2.51526564</span>
<span class="co">#&gt;  [31,] 5.259667  6.04700181</span>
<span class="co">#&gt;  [32,] 5.334661  7.49240127</span>
<span class="co">#&gt;  [33,] 7.178356  9.07923572</span>
<span class="co">#&gt;  [34,] 4.272326  5.13176431</span>
<span class="co">#&gt;  [35,] 7.803006 16.23893320</span>
<span class="co">#&gt;  [36,] 5.400352 -0.02450773</span>
<span class="co">#&gt;  [37,] 5.364526  5.81903824</span>
<span class="co">#&gt;  [38,] 4.375179  2.55865330</span>
<span class="co">#&gt;  [39,] 4.884971  3.73954846</span>
<span class="co">#&gt;  [40,] 5.542767  4.54453530</span>
<span class="co">#&gt;  [41,] 3.537782  2.05440267</span>
<span class="co">#&gt;  [42,] 3.623843  0.46435000</span>
<span class="co">#&gt;  [43,] 5.595137  6.89160480</span>
<span class="co">#&gt;  [44,] 7.719343 16.24730945</span>
<span class="co">#&gt;  [45,] 4.131773  2.84935254</span>
<span class="co">#&gt;  [46,] 4.463181  3.06910954</span>
<span class="co">#&gt;  [47,] 5.476336  4.22374722</span>
<span class="co">#&gt;  [48,] 7.729545 18.36703801</span>
<span class="co">#&gt;  [49,] 4.516719  2.43430460</span>
<span class="co">#&gt;  [50,] 5.339348  8.62556880</span>
<span class="co">#&gt;  [51,] 5.693488  5.87442571</span>
<span class="co">#&gt;  [52,] 4.532031  2.05925828</span>
<span class="co">#&gt;  [53,] 5.582909  7.30158320</span>
<span class="co">#&gt;  [54,] 5.786038  8.50980883</span>
<span class="co">#&gt;  [55,] 4.715549  2.60812490</span>
<span class="co">#&gt;  [56,] 4.362933  0.96993923</span>
<span class="co">#&gt;  [57,] 4.968405  5.85942842</span>
<span class="co">#&gt;  [58,] 5.278855  9.29175380</span>
<span class="co">#&gt;  [59,] 6.975841 10.64103766</span>
<span class="co">#&gt;  [60,] 5.191631  1.72999804</span>
<span class="co">#&gt;  [61,] 4.608410  1.01765610</span>
<span class="co">#&gt;  [62,] 3.085092 -1.36662293</span>
<span class="co">#&gt;  [63,] 6.769030  7.71041464</span>
<span class="co">#&gt;  [64,] 4.641189  1.07757022</span>
<span class="co">#&gt;  [65,] 4.702694  3.14226217</span>
<span class="co">#&gt;  [66,] 6.574819  3.56400966</span>
<span class="co">#&gt;  [67,] 5.059686  5.01798327</span>
<span class="co">#&gt;  [68,] 6.325117  6.53739996</span>
<span class="co">#&gt;  [69,] 5.411839 10.11664214</span>
<span class="co">#&gt;  [70,] 7.157186  8.32773980</span>
<span class="co">#&gt;  [71,] 5.001802  4.54347910</span>
<span class="co">#&gt;  [72,] 3.479185  1.39240724</span>
<span class="co">#&gt;  [73,] 5.820304  6.55457679</span>
<span class="co">#&gt;  [74,] 7.282633  4.32826976</span>
<span class="co">#&gt;  [75,] 3.543560  2.97936176</span>
<span class="co">#&gt;  [76,] 4.794373  0.70053797</span>
<span class="co">#&gt;  [77,] 3.413312  1.45949772</span>
<span class="co">#&gt;  [78,] 5.654014 14.49818103</span>
<span class="co">#&gt;  [79,] 5.508392  6.35601483</span>
<span class="co">#&gt;  [80,] 4.913627  2.73329919</span>
<span class="co">#&gt;  [81,] 5.890552  4.09719618</span>
<span class="co">#&gt;  [82,] 6.238446  5.21298804</span>
<span class="co">#&gt;  [83,] 4.983866  5.06540911</span>
<span class="co">#&gt;  [84,] 7.003037  6.06219477</span>
<span class="co">#&gt;  [85,] 5.603688  4.95224834</span>
<span class="co">#&gt;  [86,] 3.619360  1.79371159</span>
<span class="co">#&gt;  [87,] 4.007716  3.53193531</span>
<span class="co">#&gt;  [88,] 4.306506  0.20329664</span>
<span class="co">#&gt;  [89,] 4.241862  4.06907308</span>
<span class="co">#&gt;  [90,] 3.729627  5.82274574</span>
<span class="co">#&gt;  [91,] 5.277631  9.08278039</span>
<span class="co">#&gt;  [92,] 7.316173 10.71175371</span>
<span class="co">#&gt;  [93,] 5.572510  5.46496010</span>
<span class="co">#&gt;  [94,] 6.833482  7.47160713</span>
<span class="co">#&gt;  [95,] 4.800228  5.63758029</span>
<span class="co">#&gt;  [96,] 3.740207  1.90274261</span>
<span class="co">#&gt;  [97,] 5.080186  9.60767728</span>
<span class="co">#&gt;  [98,] 5.049081  7.41670061</span>
<span class="co">#&gt;  [99,] 4.009783  3.51883441</span>
<span class="co">#&gt; [100,] 6.287320  4.98717447</span></code></pre></div>
</div>
<div id="cross-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-validation" class="anchor"></a>Cross-Validation</h2>
<p><code>cv.sail</code> is the main function to do cross-validation along with <code>plot</code>, <code>predict</code>, and <code>coef</code> methods for objects of class <code>cv.sail</code>. We run it in parallel:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(doMC)
<span class="co">#&gt; Loading required package: foreach</span>
<span class="co">#&gt; Loading required package: iterators</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/doMC/topics/registerDoMC">registerDoMC</a></span>(<span class="dt">cores =</span> <span class="dv">2</span>)
cvfit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cv.sail.html">cv.sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e, <span class="dt">basis =</span> f.basis,
            <span class="dt">verbose =</span> <span class="dv">0</span>, <span class="dt">nfolds =</span> <span class="dv">10</span>, <span class="dt">parallel =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>We plot the cross-validated error curve which has the mean-squared error on the y-axis and <span class="math inline">\(\log(\lambda)\)</span> on the x-axis. It includes the cross-validation curve (red dotted line), and upper and lower standard deviation curves along the <span class="math inline">\(\lambda\)</span> sequence (error bars). Two selected <span class="math inline">\(\lambda\)</span>’s are indicated by the vertical dotted lines (see below). The numbers at the top of the plot represent the total number of non-zero variables at that value of <span class="math inline">\(\lambda\)</span> (<code>df_main</code> + <code>df_environment</code> + <code>df_interaction</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cvfit)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p><code>lambda.min</code> is the value of <span class="math inline">\(\lambda\)</span> that gives minimum mean cross-validated error. The other <span class="math inline">\(\lambda\)</span> saved is <code>lambda.1se</code>, which gives the most regularized model such that error is within one standard error of the minimum. We can view the selected <span class="math inline">\(\lambda\)</span>’s and the corresponding coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvfit[[<span class="st">"lambda.min"</span>]]
<span class="co">#&gt; [1] 0.1919144</span>
cvfit[[<span class="st">"lambda.1se"</span>]]
<span class="co">#&gt; [1] 0.5097415</span></code></pre></div>
<p>The estimated coefficients at <code>lambda.1se</code> and <code>lambda.min</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(<span class="kw">coef</span>(cvfit, <span class="dt">s=</span><span class="st">"lambda.1se"</span>), <span class="co"># lambda.1se is the default</span>
<span class="kw">coef</span>(cvfit, <span class="dt">s =</span> <span class="st">"lambda.min"</span>))
<span class="co">#&gt; 202 x 2 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                         1             1</span>
<span class="co">#&gt; (Intercept)  5.524692e+00   5.393931114</span>
<span class="co">#&gt; X1_1        -5.535020e-01  -0.822220730</span>
<span class="co">#&gt; X1_2         4.296505e-02   1.398918455</span>
<span class="co">#&gt; X1_3         2.335016e-01   1.273167303</span>
<span class="co">#&gt; X1_4         5.285136e-01   1.238901919</span>
<span class="co">#&gt; X1_5         1.458328e+00   2.988908642</span>
<span class="co">#&gt; X2_1         .              0.131584670</span>
<span class="co">#&gt; X2_2         .             -3.032948729</span>
<span class="co">#&gt; X2_3         .             -2.662164812</span>
<span class="co">#&gt; X2_4         .             -0.297786022</span>
<span class="co">#&gt; X2_5         .             -1.706795571</span>
<span class="co">#&gt; X3_1         2.909152e+00   5.071159593</span>
<span class="co">#&gt; X3_2         1.420194e+00   3.529153250</span>
<span class="co">#&gt; X3_3        -1.017524e+00  -1.036358490</span>
<span class="co">#&gt; X3_4        -2.050315e+00  -2.402735424</span>
<span class="co">#&gt; X3_5        -1.223299e+00  -0.914129140</span>
<span class="co">#&gt; X4_1         4.183501e+00   6.931652423</span>
<span class="co">#&gt; X4_2        -2.637339e+00  -2.255139394</span>
<span class="co">#&gt; X4_3        -6.105220e+00  -9.100252546</span>
<span class="co">#&gt; X4_4        -3.315902e+00  -3.354749246</span>
<span class="co">#&gt; X4_5        -6.511128e-01  -0.827429642</span>
<span class="co">#&gt; X5_1         .              .          </span>
<span class="co">#&gt; X5_2         .              .          </span>
<span class="co">#&gt; X5_3         .              .          </span>
<span class="co">#&gt; X5_4         .              .          </span>
<span class="co">#&gt; X5_5         .              .          </span>
<span class="co">#&gt; X6_1         .              .          </span>
<span class="co">#&gt; X6_2         .              .          </span>
<span class="co">#&gt; X6_3         .              .          </span>
<span class="co">#&gt; X6_4         .              .          </span>
<span class="co">#&gt; X6_5         .              .          </span>
<span class="co">#&gt; X7_1         .              .          </span>
<span class="co">#&gt; X7_2         .              .          </span>
<span class="co">#&gt; X7_3         .              .          </span>
<span class="co">#&gt; X7_4         .              .          </span>
<span class="co">#&gt; X7_5         .              .          </span>
<span class="co">#&gt; X8_1         1.468052e-01   1.041269779</span>
<span class="co">#&gt; X8_2         9.877758e-02   0.945535230</span>
<span class="co">#&gt; X8_3         1.522655e-02   0.372651807</span>
<span class="co">#&gt; X8_4        -9.507427e-02  -0.461758478</span>
<span class="co">#&gt; X8_5        -2.051683e-01  -1.206441228</span>
<span class="co">#&gt; X9_1         .              .          </span>
<span class="co">#&gt; X9_2         .              .          </span>
<span class="co">#&gt; X9_3         .              .          </span>
<span class="co">#&gt; X9_4         .              .          </span>
<span class="co">#&gt; X9_5         .              .          </span>
<span class="co">#&gt; X10_1        .              .          </span>
<span class="co">#&gt; X10_2        .              .          </span>
<span class="co">#&gt; X10_3        .              .          </span>
<span class="co">#&gt; X10_4        .              .          </span>
<span class="co">#&gt; X10_5        .              .          </span>
<span class="co">#&gt; X11_1        2.194283e-03   0.388512930</span>
<span class="co">#&gt; X11_2        5.884922e-04  -0.022040750</span>
<span class="co">#&gt; X11_3       -1.060758e-03  -0.151779956</span>
<span class="co">#&gt; X11_4       -3.266061e-03  -1.294662723</span>
<span class="co">#&gt; X11_5       -3.466141e-03  -1.560570934</span>
<span class="co">#&gt; X12_1        .              .          </span>
<span class="co">#&gt; X12_2        .              .          </span>
<span class="co">#&gt; X12_3        .              .          </span>
<span class="co">#&gt; X12_4        .              .          </span>
<span class="co">#&gt; X12_5        .              .          </span>
<span class="co">#&gt; X13_1        .              .          </span>
<span class="co">#&gt; X13_2        .              .          </span>
<span class="co">#&gt; X13_3        .              .          </span>
<span class="co">#&gt; X13_4        .              .          </span>
<span class="co">#&gt; X13_5        .              .          </span>
<span class="co">#&gt; X14_1        .              .          </span>
<span class="co">#&gt; X14_2        .              .          </span>
<span class="co">#&gt; X14_3        .              .          </span>
<span class="co">#&gt; X14_4        .              .          </span>
<span class="co">#&gt; X14_5        .              .          </span>
<span class="co">#&gt; X15_1        .              .          </span>
<span class="co">#&gt; X15_2        .              .          </span>
<span class="co">#&gt; X15_3        .              .          </span>
<span class="co">#&gt; X15_4        .              .          </span>
<span class="co">#&gt; X15_5        .              .          </span>
<span class="co">#&gt; X16_1        .              .          </span>
<span class="co">#&gt; X16_2        .              .          </span>
<span class="co">#&gt; X16_3        .              .          </span>
<span class="co">#&gt; X16_4        .              .          </span>
<span class="co">#&gt; X16_5        .              .          </span>
<span class="co">#&gt; X17_1        .              .          </span>
<span class="co">#&gt; X17_2        .              .          </span>
<span class="co">#&gt; X17_3        .              .          </span>
<span class="co">#&gt; X17_4        .              .          </span>
<span class="co">#&gt; X17_5        .              .          </span>
<span class="co">#&gt; X18_1        .              .          </span>
<span class="co">#&gt; X18_2        .              .          </span>
<span class="co">#&gt; X18_3        .              .          </span>
<span class="co">#&gt; X18_4        .              .          </span>
<span class="co">#&gt; X18_5        .              .          </span>
<span class="co">#&gt; X19_1        .              .          </span>
<span class="co">#&gt; X19_2        .              .          </span>
<span class="co">#&gt; X19_3        .              .          </span>
<span class="co">#&gt; X19_4        .              .          </span>
<span class="co">#&gt; X19_5        .              .          </span>
<span class="co">#&gt; X20_1        .              0.962992457</span>
<span class="co">#&gt; X20_2        .             -0.211677340</span>
<span class="co">#&gt; X20_3        .             -1.447385488</span>
<span class="co">#&gt; X20_4        .             -1.462929815</span>
<span class="co">#&gt; X20_5        .              0.956589883</span>
<span class="co">#&gt; E            1.926923e+00   2.435966886</span>
<span class="co">#&gt; X1_1:E       .             -0.033853053</span>
<span class="co">#&gt; X1_2:E       .              0.057597260</span>
<span class="co">#&gt; X1_3:E       .              0.052419744</span>
<span class="co">#&gt; X1_4:E       .              0.051008946</span>
<span class="co">#&gt; X1_5:E       .              0.123061460</span>
<span class="co">#&gt; X2_1:E       .              0.455648582</span>
<span class="co">#&gt; X2_2:E       .            -10.502429995</span>
<span class="co">#&gt; X2_3:E       .             -9.218487378</span>
<span class="co">#&gt; X2_4:E       .             -1.031167069</span>
<span class="co">#&gt; X2_5:E       .             -5.910255203</span>
<span class="co">#&gt; X3_1:E       8.665690e-01   2.354222494</span>
<span class="co">#&gt; X3_2:E       4.230430e-01   1.638365312</span>
<span class="co">#&gt; X3_3:E      -3.030969e-01  -0.481116483</span>
<span class="co">#&gt; X3_4:E      -6.107414e-01  -1.115439907</span>
<span class="co">#&gt; X3_5:E      -3.643923e-01  -0.424373034</span>
<span class="co">#&gt; X4_1:E       8.078422e+00  11.458113806</span>
<span class="co">#&gt; X4_2:E      -5.092753e+00  -3.727775464</span>
<span class="co">#&gt; X4_3:E      -1.178930e+01 -15.042838702</span>
<span class="co">#&gt; X4_4:E      -6.403072e+00  -5.545445199</span>
<span class="co">#&gt; X4_5:E      -1.257311e+00  -1.367752223</span>
<span class="co">#&gt; X5_1:E       .              .          </span>
<span class="co">#&gt; X5_2:E       .              .          </span>
<span class="co">#&gt; X5_3:E       .              .          </span>
<span class="co">#&gt; X5_4:E       .              .          </span>
<span class="co">#&gt; X5_5:E       .              .          </span>
<span class="co">#&gt; X6_1:E       .              .          </span>
<span class="co">#&gt; X6_2:E       .              .          </span>
<span class="co">#&gt; X6_3:E       .              .          </span>
<span class="co">#&gt; X6_4:E       .              .          </span>
<span class="co">#&gt; X6_5:E       .              .          </span>
<span class="co">#&gt; X7_1:E       .              .          </span>
<span class="co">#&gt; X7_2:E       .              .          </span>
<span class="co">#&gt; X7_3:E       .              .          </span>
<span class="co">#&gt; X7_4:E       .              .          </span>
<span class="co">#&gt; X7_5:E       .              .          </span>
<span class="co">#&gt; X8_1:E       .              1.122704862</span>
<span class="co">#&gt; X8_2:E       .              1.019483156</span>
<span class="co">#&gt; X8_3:E       .              0.401795965</span>
<span class="co">#&gt; X8_4:E       .             -0.497871444</span>
<span class="co">#&gt; X8_5:E       .             -1.300793953</span>
<span class="co">#&gt; X9_1:E       .              .          </span>
<span class="co">#&gt; X9_2:E       .              .          </span>
<span class="co">#&gt; X9_3:E       .              .          </span>
<span class="co">#&gt; X9_4:E       .              .          </span>
<span class="co">#&gt; X9_5:E       .              .          </span>
<span class="co">#&gt; X10_1:E      .              .          </span>
<span class="co">#&gt; X10_2:E      .              .          </span>
<span class="co">#&gt; X10_3:E      .              .          </span>
<span class="co">#&gt; X10_4:E      .              .          </span>
<span class="co">#&gt; X10_5:E      .              .          </span>
<span class="co">#&gt; X11_1:E      .              0.138707094</span>
<span class="co">#&gt; X11_2:E      .             -0.007869001</span>
<span class="co">#&gt; X11_3:E      .             -0.054188561</span>
<span class="co">#&gt; X11_4:E      .             -0.462221177</span>
<span class="co">#&gt; X11_5:E      .             -0.557155869</span>
<span class="co">#&gt; X12_1:E      .              .          </span>
<span class="co">#&gt; X12_2:E      .              .          </span>
<span class="co">#&gt; X12_3:E      .              .          </span>
<span class="co">#&gt; X12_4:E      .              .          </span>
<span class="co">#&gt; X12_5:E      .              .          </span>
<span class="co">#&gt; X13_1:E      .              .          </span>
<span class="co">#&gt; X13_2:E      .              .          </span>
<span class="co">#&gt; X13_3:E      .              .          </span>
<span class="co">#&gt; X13_4:E      .              .          </span>
<span class="co">#&gt; X13_5:E      .              .          </span>
<span class="co">#&gt; X14_1:E      .              .          </span>
<span class="co">#&gt; X14_2:E      .              .          </span>
<span class="co">#&gt; X14_3:E      .              .          </span>
<span class="co">#&gt; X14_4:E      .              .          </span>
<span class="co">#&gt; X14_5:E      .              .          </span>
<span class="co">#&gt; X15_1:E      .              .          </span>
<span class="co">#&gt; X15_2:E      .              .          </span>
<span class="co">#&gt; X15_3:E      .              .          </span>
<span class="co">#&gt; X15_4:E      .              .          </span>
<span class="co">#&gt; X15_5:E      .              .          </span>
<span class="co">#&gt; X16_1:E      .              .          </span>
<span class="co">#&gt; X16_2:E      .              .          </span>
<span class="co">#&gt; X16_3:E      .              .          </span>
<span class="co">#&gt; X16_4:E      .              .          </span>
<span class="co">#&gt; X16_5:E      .              .          </span>
<span class="co">#&gt; X17_1:E      .              .          </span>
<span class="co">#&gt; X17_2:E      .              .          </span>
<span class="co">#&gt; X17_3:E      .              .          </span>
<span class="co">#&gt; X17_4:E      .              .          </span>
<span class="co">#&gt; X17_5:E      .              .          </span>
<span class="co">#&gt; X18_1:E      .              .          </span>
<span class="co">#&gt; X18_2:E      .              .          </span>
<span class="co">#&gt; X18_3:E      .              .          </span>
<span class="co">#&gt; X18_4:E      .              .          </span>
<span class="co">#&gt; X18_5:E      .              .          </span>
<span class="co">#&gt; X19_1:E      .              .          </span>
<span class="co">#&gt; X19_2:E      .              .          </span>
<span class="co">#&gt; X19_3:E      .              .          </span>
<span class="co">#&gt; X19_4:E      .              .          </span>
<span class="co">#&gt; X19_5:E      .              .          </span>
<span class="co">#&gt; X20_1:E      .              .          </span>
<span class="co">#&gt; X20_2:E      .              .          </span>
<span class="co">#&gt; X20_3:E      .              .          </span>
<span class="co">#&gt; X20_4:E      .              .          </span>
<span class="co">#&gt; X20_5:E      .              .</span></code></pre></div>
<p>Estimated non-zero coefficients at <code>lambda.1se</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(cvfit, <span class="dt">type =</span> <span class="st">"nonzero"</span>)
<span class="co">#&gt;                         1</span>
<span class="co">#&gt; (Intercept)  5.524692e+00</span>
<span class="co">#&gt; X1_1        -5.535020e-01</span>
<span class="co">#&gt; X1_2         4.296505e-02</span>
<span class="co">#&gt; X1_3         2.335016e-01</span>
<span class="co">#&gt; X1_4         5.285136e-01</span>
<span class="co">#&gt; X1_5         1.458328e+00</span>
<span class="co">#&gt; X3_1         2.909152e+00</span>
<span class="co">#&gt; X3_2         1.420194e+00</span>
<span class="co">#&gt; X3_3        -1.017524e+00</span>
<span class="co">#&gt; X3_4        -2.050315e+00</span>
<span class="co">#&gt; X3_5        -1.223299e+00</span>
<span class="co">#&gt; X4_1         4.183501e+00</span>
<span class="co">#&gt; X4_2        -2.637339e+00</span>
<span class="co">#&gt; X4_3        -6.105220e+00</span>
<span class="co">#&gt; X4_4        -3.315902e+00</span>
<span class="co">#&gt; X4_5        -6.511128e-01</span>
<span class="co">#&gt; X8_1         1.468052e-01</span>
<span class="co">#&gt; X8_2         9.877758e-02</span>
<span class="co">#&gt; X8_3         1.522655e-02</span>
<span class="co">#&gt; X8_4        -9.507427e-02</span>
<span class="co">#&gt; X8_5        -2.051683e-01</span>
<span class="co">#&gt; X11_1        2.194283e-03</span>
<span class="co">#&gt; X11_2        5.884922e-04</span>
<span class="co">#&gt; X11_3       -1.060758e-03</span>
<span class="co">#&gt; X11_4       -3.266061e-03</span>
<span class="co">#&gt; X11_5       -3.466141e-03</span>
<span class="co">#&gt; E            1.926923e+00</span>
<span class="co">#&gt; X3_1:E       8.665690e-01</span>
<span class="co">#&gt; X3_2:E       4.230430e-01</span>
<span class="co">#&gt; X3_3:E      -3.030969e-01</span>
<span class="co">#&gt; X3_4:E      -6.107414e-01</span>
<span class="co">#&gt; X3_5:E      -3.643923e-01</span>
<span class="co">#&gt; X4_1:E       8.078422e+00</span>
<span class="co">#&gt; X4_2:E      -5.092753e+00</span>
<span class="co">#&gt; X4_3:E      -1.178930e+01</span>
<span class="co">#&gt; X4_4:E      -6.403072e+00</span>
<span class="co">#&gt; X4_5:E      -1.257311e+00</span></code></pre></div>
</div>
<div id="visualizing-the-effect-of-the-non-linear-terms" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-effect-of-the-non-linear-terms" class="anchor"></a>Visualizing the Effect of the Non-linear Terms</h2>
<p>bsplines are difficult to interpret. We provide a plotting function to visualize the effect of the non-linear function on the response.</p>
<div id="main-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#main-effects" class="anchor"></a>Main Effects</h3>
<p>Since we are using simulated data, we also plot the true curve:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotMain.html">plotMain</a></span>(cvfit<span class="op">$</span>sail.fit, <span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">xvar =</span> <span class="st">"X3"</span>,
         <span class="dt">legend.position =</span> <span class="st">"topright"</span>,
         <span class="dt">s =</span> cvfit<span class="op">$</span>lambda.min, <span class="dt">f.truth =</span> sailsim<span class="op">$</span>f3)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="interaction-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#interaction-effects" class="anchor"></a>Interaction Effects</h3>
<p>Again, since we are using simulated data, we also plot the true interaction:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotInter.html">plotInter</a></span>(cvfit<span class="op">$</span>sail.fit, <span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">xvar =</span> <span class="st">"X4"</span>,
          <span class="dt">f.truth =</span> sailsim<span class="op">$</span>f4.inter,
          <span class="dt">s =</span> cvfit<span class="op">$</span>lambda.min,
          <span class="dt">title_z =</span> <span class="st">"Estimated"</span>)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div id="linear-interactions" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-interactions" class="anchor"></a>Linear Interactions</h2>
<p>The <code>basis</code> argument in the <code>sail</code> function is very flexible in that it allows you to apply <strong>any</strong> basis expansion to the columns of <span class="math inline">\(\mathbf{X}\)</span>. Of course, there might be situations where you do not expect any non-linear main effects or interactions to be present in your data. You can still use the <code>sail</code> method to search for <strong>linear</strong> main effects and interactions. This can be accomplished by specifying an identity map:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f.identity &lt;-<span class="st"> </span><span class="cf">function</span>(i) i</code></pre></div>
<p>We then pass this function to <code>basis</code> argument in <code>cv.sail</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvfit_linear &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cv.sail.html">cv.sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e,
                        <span class="dt">basis =</span> f.identity, <span class="dt">nfolds =</span> <span class="dv">10</span>, <span class="dt">parallel =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Index: 1, lambda: 1.4184</span>
<span class="co">#&gt; Index: 2, lambda: 1.2924</span>
<span class="co">#&gt; Index: 3, lambda: 1.1776</span>
<span class="co">#&gt; Index: 4, lambda: 1.0730</span>
<span class="co">#&gt; Index: 5, lambda: 0.9776</span>
<span class="co">#&gt; Index: 6, lambda: 0.8908</span>
<span class="co">#&gt; Index: 7, lambda: 0.8117</span>
<span class="co">#&gt; Index: 8, lambda: 0.7395</span>
<span class="co">#&gt; Index: 9, lambda: 0.6738</span>
<span class="co">#&gt; Index: 10, lambda: 0.6140</span>
<span class="co">#&gt; Index: 11, lambda: 0.5594</span>
<span class="co">#&gt; Index: 12, lambda: 0.5097</span>
<span class="co">#&gt; Index: 13, lambda: 0.4645</span>
<span class="co">#&gt; Index: 14, lambda: 0.4232</span>
<span class="co">#&gt; Index: 15, lambda: 0.3856</span>
<span class="co">#&gt; Index: 16, lambda: 0.3513</span>
<span class="co">#&gt; Index: 17, lambda: 0.3201</span>
<span class="co">#&gt; Index: 18, lambda: 0.2917</span>
<span class="co">#&gt; Index: 19, lambda: 0.2658</span>
<span class="co">#&gt; Index: 20, lambda: 0.2422</span>
<span class="co">#&gt; Index: 21, lambda: 0.2207</span>
<span class="co">#&gt; Index: 22, lambda: 0.2011</span>
<span class="co">#&gt; Index: 23, lambda: 0.1832</span>
<span class="co">#&gt; Index: 24, lambda: 0.1669</span>
<span class="co">#&gt; Index: 25, lambda: 0.1521</span>
<span class="co">#&gt; Index: 26, lambda: 0.1386</span>
<span class="co">#&gt; Index: 27, lambda: 0.1263</span>
<span class="co">#&gt; Index: 28, lambda: 0.1150</span>
<span class="co">#&gt; Index: 29, lambda: 0.1048</span>
<span class="co">#&gt; Index: 30, lambda: 0.0955</span>
<span class="co">#&gt; Index: 31, lambda: 0.0870</span>
<span class="co">#&gt; Index: 32, lambda: 0.0793</span>
<span class="co">#&gt; Index: 33, lambda: 0.0723</span>
<span class="co">#&gt; Index: 34, lambda: 0.0658</span>
<span class="co">#&gt; Index: 35, lambda: 0.0600</span>
<span class="co">#&gt; Index: 36, lambda: 0.0547</span>
<span class="co">#&gt; Index: 37, lambda: 0.0498</span>
<span class="co">#&gt; Index: 38, lambda: 0.0454</span>
<span class="co">#&gt; Index: 39, lambda: 0.0413</span>
<span class="co">#&gt; Index: 40, lambda: 0.0377</span>
<span class="co">#&gt; Index: 41, lambda: 0.0343</span>
<span class="co">#&gt; Index: 42, lambda: 0.0313</span>
<span class="co">#&gt; Index: 43, lambda: 0.0285</span>
<span class="co">#&gt; Index: 44, lambda: 0.0260</span>
<span class="co">#&gt; Index: 45, lambda: 0.0237</span>
<span class="co">#&gt; Index: 46, lambda: 0.0216</span>
<span class="co">#&gt; Index: 47, lambda: 0.0196</span>
<span class="co">#&gt; Index: 48, lambda: 0.0179</span>
<span class="co">#&gt; Index: 49, lambda: 0.0163</span>
<span class="co">#&gt; Index: 50, lambda: 0.0149</span>
<span class="co">#&gt; Index: 51, lambda: 0.0135</span>
<span class="co">#&gt; Index: 52, lambda: 0.0123</span>
<span class="co">#&gt; Index: 53, lambda: 0.0112</span>
<span class="co">#&gt; Index: 54, lambda: 0.0102</span>
<span class="co">#&gt; Index: 55, lambda: 0.0093</span>
<span class="co">#&gt; Index: 56, lambda: 0.0085</span>
<span class="co">#&gt; Index: 57, lambda: 0.0077</span>
<span class="co">#&gt; Index: 58, lambda: 0.0071</span>
<span class="co">#&gt; Index: 59, lambda: 0.0064</span>
<span class="co">#&gt; Index: 60, lambda: 0.0059</span>
<span class="co">#&gt; Index: 61, lambda: 0.0053</span>
<span class="co">#&gt; Index: 62, lambda: 0.0049</span>
<span class="co">#&gt; Index: 63, lambda: 0.0044</span>
<span class="co">#&gt; Index: 64, lambda: 0.0040</span>
<span class="co">#&gt; Index: 65, lambda: 0.0037</span>
<span class="co">#&gt; Index: 66, lambda: 0.0034</span>
<span class="co">#&gt; Index: 67, lambda: 0.0031</span>
<span class="co">#&gt; Index: 68, lambda: 0.0028</span></code></pre></div>
<p>Next we plot the cross-validated curve:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cvfit_linear)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>And extract the model at <code>lambda.min</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(cvfit_linear, <span class="dt">s =</span> <span class="st">"lambda.min"</span>)
<span class="co">#&gt; 42 x 1 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                       1</span>
<span class="co">#&gt; (Intercept)   5.5349388</span>
<span class="co">#&gt; X1_1          2.1098433</span>
<span class="co">#&gt; X2_1          .        </span>
<span class="co">#&gt; X3_1         -3.7113805</span>
<span class="co">#&gt; X4_1         -6.0928298</span>
<span class="co">#&gt; X5_1          .        </span>
<span class="co">#&gt; X6_1          .        </span>
<span class="co">#&gt; X7_1          .        </span>
<span class="co">#&gt; X8_1         -0.6603712</span>
<span class="co">#&gt; X9_1          .        </span>
<span class="co">#&gt; X10_1         .        </span>
<span class="co">#&gt; X11_1        -2.6138900</span>
<span class="co">#&gt; X12_1         .        </span>
<span class="co">#&gt; X13_1         .        </span>
<span class="co">#&gt; X14_1        -1.1628492</span>
<span class="co">#&gt; X15_1         .        </span>
<span class="co">#&gt; X16_1         2.5387775</span>
<span class="co">#&gt; X17_1         .        </span>
<span class="co">#&gt; X18_1         .        </span>
<span class="co">#&gt; X19_1         .        </span>
<span class="co">#&gt; X20_1         .        </span>
<span class="co">#&gt; E             2.0874458</span>
<span class="co">#&gt; X1_1:E       -1.0586744</span>
<span class="co">#&gt; X2_1:E        .        </span>
<span class="co">#&gt; X3_1:E       -1.5035178</span>
<span class="co">#&gt; X4_1:E      -10.8144229</span>
<span class="co">#&gt; X5_1:E        .        </span>
<span class="co">#&gt; X6_1:E        .        </span>
<span class="co">#&gt; X7_1:E        .        </span>
<span class="co">#&gt; X8_1:E        .        </span>
<span class="co">#&gt; X9_1:E        .        </span>
<span class="co">#&gt; X10_1:E       .        </span>
<span class="co">#&gt; X11_1:E      -1.8596248</span>
<span class="co">#&gt; X12_1:E       .        </span>
<span class="co">#&gt; X13_1:E       .        </span>
<span class="co">#&gt; X14_1:E       .        </span>
<span class="co">#&gt; X15_1:E       .        </span>
<span class="co">#&gt; X16_1:E       5.2961920</span>
<span class="co">#&gt; X17_1:E       .        </span>
<span class="co">#&gt; X18_1:E       .        </span>
<span class="co">#&gt; X19_1:E       .        </span>
<span class="co">#&gt; X20_1:E       .</span></code></pre></div>
</div>
<div id="applying-a-different-penalty-to-each-predictor" class="section level2">
<h2 class="hasAnchor">
<a href="#applying-a-different-penalty-to-each-predictor" class="anchor"></a>Applying a different penalty to each predictor</h2>
<p>Recall that we consider the following penalized least squares criterion for this problem:</p>
<span class="math display">\[\begin{equation}
\arg\min_{\boldsymbol{\theta} }  \mathcal{L}(Y;\boldsymbol{\theta}) + \lambda (1-\alpha)  \left( w_E |\beta_E| + \sum_{j=1}^{p} w_j \lVert\boldsymbol{\theta}_j \rVert_2 \right) +  \lambda\alpha \sum_{j=1}^{p} w_{jE} |\gamma_{j}| 
\end{equation}\]</span>
<p>The weights <span class="math inline">\(w_E, w_j, w_{jE}\)</span> are by default set to 1 as specified by the <code>penalty.factor</code> argument. This argument allows users to apply separate penalty factors to each coefficient. In particular, any variable with <code>penalty.factor</code> equal to zero is not penalized at all. This feature can be applied mainly for two reasons:</p>
<ol style="list-style-type: decimal">
<li>Prior knowledge about the importance of certain variables is known. Larger weights will penalize the variable more, while smaller weights will penalize the variable less<br>
</li>
<li>Allows users to apply the Adaptive <code>sail</code>, similar to the <a href="http://users.stat.umn.edu/~zouxx019/Papers/adalasso.pdf">Adaptive Lasso</a>
</li>
</ol>
<p>In the following example, we want the environment variable to always be included so we set the first element of <code>p.fac</code> to zero. We also want to apply less of a penalty to the main effects for <span class="math inline">\(X_2, X_3, X_4\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the weights correspond to E, X1, X2, X3, ... X_p, X1:E, X2:E, ... X_p:E</span>
p.fac &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="op">*</span><span class="kw">ncol</span>(sailsim<span class="op">$</span>x) <span class="op">-</span><span class="st"> </span><span class="dv">4</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_pf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sail.html">sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e, <span class="dt">basis =</span> f.basis,
               <span class="dt">penalty.factor =</span> p.fac)
<span class="co">#&gt; Index: 1, lambda: 1.9739</span>
<span class="co">#&gt; Index: 2, lambda: 1.8842</span>
<span class="co">#&gt; Index: 3, lambda: 1.7985</span>
<span class="co">#&gt; Index: 4, lambda: 1.7168</span>
<span class="co">#&gt; Index: 5, lambda: 1.6387</span>
<span class="co">#&gt; Index: 6, lambda: 1.5643</span>
<span class="co">#&gt; Index: 7, lambda: 1.4932</span>
<span class="co">#&gt; Index: 8, lambda: 1.4253</span>
<span class="co">#&gt; Index: 9, lambda: 1.3605</span>
<span class="co">#&gt; Index: 10, lambda: 1.2987</span>
<span class="co">#&gt; Index: 11, lambda: 1.2396</span>
<span class="co">#&gt; Index: 12, lambda: 1.1833</span>
<span class="co">#&gt; Index: 13, lambda: 1.1295</span>
<span class="co">#&gt; Index: 14, lambda: 1.0782</span>
<span class="co">#&gt; Index: 15, lambda: 1.0292</span>
<span class="co">#&gt; Index: 16, lambda: 0.9824</span>
<span class="co">#&gt; Index: 17, lambda: 0.9377</span>
<span class="co">#&gt; Index: 18, lambda: 0.8951</span>
<span class="co">#&gt; Index: 19, lambda: 0.8544</span>
<span class="co">#&gt; Index: 20, lambda: 0.8156</span>
<span class="co">#&gt; Index: 21, lambda: 0.7785</span>
<span class="co">#&gt; Index: 22, lambda: 0.7431</span>
<span class="co">#&gt; Index: 23, lambda: 0.7094</span>
<span class="co">#&gt; Index: 24, lambda: 0.6771</span>
<span class="co">#&gt; Index: 25, lambda: 0.6464</span>
<span class="co">#&gt; Index: 26, lambda: 0.6170</span>
<span class="co">#&gt; Index: 27, lambda: 0.5889</span>
<span class="co">#&gt; Index: 28, lambda: 0.5622</span>
<span class="co">#&gt; Index: 29, lambda: 0.5366</span>
<span class="co">#&gt; Index: 30, lambda: 0.5122</span>
<span class="co">#&gt; Index: 31, lambda: 0.4889</span>
<span class="co">#&gt; Index: 32, lambda: 0.4667</span>
<span class="co">#&gt; Index: 33, lambda: 0.4455</span>
<span class="co">#&gt; Index: 34, lambda: 0.4253</span>
<span class="co">#&gt; Index: 35, lambda: 0.4059</span>
<span class="co">#&gt; Index: 36, lambda: 0.3875</span>
<span class="co">#&gt; Index: 37, lambda: 0.3699</span>
<span class="co">#&gt; Index: 38, lambda: 0.3531</span>
<span class="co">#&gt; Index: 39, lambda: 0.3370</span>
<span class="co">#&gt; Index: 40, lambda: 0.3217</span>
<span class="co">#&gt; Index: 41, lambda: 0.3071</span>
<span class="co">#&gt; Index: 42, lambda: 0.2931</span>
<span class="co">#&gt; Index: 43, lambda: 0.2798</span>
<span class="co">#&gt; Index: 44, lambda: 0.2671</span>
<span class="co">#&gt; Index: 45, lambda: 0.2549</span>
<span class="co">#&gt; Index: 46, lambda: 0.2433</span>
<span class="co">#&gt; Index: 47, lambda: 0.2323</span>
<span class="co">#&gt; Index: 48, lambda: 0.2217</span>
<span class="co">#&gt; Index: 49, lambda: 0.2117</span>
<span class="co">#&gt; Index: 50, lambda: 0.2020</span>
<span class="co">#&gt; Index: 51, lambda: 0.1928</span>
<span class="co">#&gt; Index: 52, lambda: 0.1841</span>
<span class="co">#&gt; Index: 53, lambda: 0.1757</span>
<span class="co">#&gt; Index: 54, lambda: 0.1677</span>
<span class="co">#&gt; Index: 55, lambda: 0.1601</span>
<span class="co">#&gt; Index: 56, lambda: 0.1528</span>
<span class="co">#&gt; Index: 57, lambda: 0.1459</span>
<span class="co">#&gt; Index: 58, lambda: 0.1393</span>
<span class="co">#&gt; Index: 59, lambda: 0.1329</span>
<span class="co">#&gt; Index: 60, lambda: 0.1269</span>
<span class="co">#&gt; Index: 61, lambda: 0.1211</span>
<span class="co">#&gt; Index: 62, lambda: 0.1156</span>
<span class="co">#&gt; Index: 63, lambda: 0.1104</span>
<span class="co">#&gt; Index: 64, lambda: 0.1053</span>
<span class="co">#&gt; Index: 65, lambda: 0.1006</span>
<span class="co">#&gt; Index: 66, lambda: 0.0960</span>
<span class="co">#&gt; Index: 67, lambda: 0.0916</span>
<span class="co">#&gt; Index: 68, lambda: 0.0875</span>
<span class="co">#&gt; Index: 69, lambda: 0.0835</span>
<span class="co">#&gt; Index: 70, lambda: 0.0797</span>
<span class="co">#&gt; Index: 71, lambda: 0.0761</span>
<span class="co">#&gt; Index: 72, lambda: 0.0726</span>
<span class="co">#&gt; Index: 73, lambda: 0.0693</span>
<span class="co">#&gt; Index: 74, lambda: 0.0662</span>
<span class="co">#&gt; Index: 75, lambda: 0.0631</span>
<span class="co">#&gt; Index: 76, lambda: 0.0603</span>
<span class="co">#&gt; Index: 77, lambda: 0.0575</span>
<span class="co">#&gt; Index: 78, lambda: 0.0549</span>
<span class="co">#&gt; Index: 79, lambda: 0.0524</span>
<span class="co">#&gt; Index: 80, lambda: 0.0500</span>
<span class="co">#&gt; Index: 81, lambda: 0.0478</span>
<span class="co">#&gt; Index: 82, lambda: 0.0456</span>
<span class="co">#&gt; Index: 83, lambda: 0.0435</span>
<span class="co">#&gt; Index: 84, lambda: 0.0415</span>
<span class="co">#&gt; Index: 85, lambda: 0.0397</span>
<span class="co">#&gt; Index: 86, lambda: 0.0379</span>
<span class="co">#&gt; Index: 87, lambda: 0.0361</span>
<span class="co">#&gt; Index: 88, lambda: 0.0345</span>
<span class="co">#&gt; Index: 89, lambda: 0.0329</span>
<span class="co">#&gt; Index: 90, lambda: 0.0314</span>
<span class="co">#&gt; Index: 91, lambda: 0.0300</span>
<span class="co">#&gt; Index: 92, lambda: 0.0286</span>
<span class="co">#&gt; Index: 93, lambda: 0.0273</span>
<span class="co">#&gt; Index: 94, lambda: 0.0261</span>
<span class="co">#&gt; Index: 95, lambda: 0.0249</span>
<span class="co">#&gt; Index: 96, lambda: 0.0238</span>
<span class="co">#&gt; Index: 97, lambda: 0.0227</span>
<span class="co">#&gt; Index: 98, lambda: 0.0217</span>
<span class="co">#&gt; Index: 99, lambda: 0.0207</span>
<span class="co">#&gt; Index: 100, lambda: 0.0197</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fit_pf)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>We see from the plot above that the black line (corresponding to the <span class="math inline">\(E\)</span> variable with <code>penalty.factor</code> equal to zero) is always included in the model.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#model">Model</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#quick-start">Quick Start</a></li>
      <li><a href="#cross-validation">Cross-Validation</a></li>
      <li><a href="#visualizing-the-effect-of-the-non-linear-terms">Visualizing the Effect of the Non-linear Terms</a></li>
      <li><a href="#linear-interactions">Linear Interactions</a></li>
      <li><a href="#applying-a-different-penalty-to-each-predictor">Applying a different penalty to each predictor</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://sahirbhatnagar.com">Sahir Bhatnagar</a>, <a href="http://www.math.mcgill.ca/yyang/">Yi Yang</a>, <a href="https://www.mcgill.ca/statisticalgenetics/">Celia Greenwood</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
