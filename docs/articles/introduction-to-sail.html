<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the sail package • sail</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the sail package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- docsearch --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sail</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction-to-sail.html">Introduction to sail</a>
    </li>
    <li>
      <a href="../articles/user-defined-design.html">User defined design matrix</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sahirbhatnagar/sail">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to the sail package</h1>
                        <h4 class="author">Sahir Rai Bhatnagar</h4>
            
            <h4 class="date">2018-04-18</h4>
      
      <small>Source: <a href="https://github.com/sahirbhatnagar/sail/blob/master/vignettes/introduction-to-sail.Rmd"><code>vignettes/introduction-to-sail.Rmd</code></a></small>
      <div class="hidden name"><code>introduction-to-sail.Rmd</code></div>

    </div>

    
    
<p><code>sail</code> is a package that fits a linear model with non-linear interactions via penalized maximum likelihood. The regularization path is computed at a grid of values for the regularization parameter <span class="math inline">\(\lambda\)</span> and a fixed value of the second regularization parameter <span class="math inline">\(\alpha\)</span>. The method enforces the strong heredity property, i.e., an interaction is selected only if its corresponding main effects are also included. The interactions are limited to a single exposure variable, i.e., <span class="math inline">\(y \sim e + x_1 + x_2 + e*x_1 + e*x_2 + \epsilon\)</span>. Furthermore, this package allows a user-defined basis expansion on the <span class="math inline">\(x\)</span> variables to allow for non-linear effects. The default is bsplines (e.g. <code><a href="http://www.rdocumentation.org/packages/splines/topics/bs">splines::bs(x, 5)</a></code>). It currently only fits linear models (binomial models are due in the next release).</p>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
Let <span class="math inline">\(Y=(Y_1, \ldots, Y_n) \in \mathbb{R}^n\)</span> be a continuous outcome variable,  a binary or continuous environment vector,  a matrix of predictors, and <span class="math inline">\(\varepsilon = (\varepsilon_1, \ldots, \varepsilon_n) \in \mathbb{R}^n\)</span> a vector of i.i.d random variables with mean 0. Furthermore let <span class="math inline">\(f_j: \mathbb{R} \rightarrow \mathbb{R}\)</span> be a smoothing method for variable <span class="math inline">\(X_j\)</span> by a projection on to a set of basis functions:
<span class="math display">\[\begin{equation}
f_j(X_j) = \sum_{\ell = 1}^{m_j} \psi_{j\ell}(X_j) \beta_{j\ell} \label{eq:smooth}
\end{equation}\]</span>
Here, the <span class="math inline">\(\left\lbrace \psi_{j\ell} \right\rbrace_1^{m_j}\)</span> are a family of basis functions in <span class="math inline">\(X_j\)</span>~. Let <span class="math inline">\(\boldsymbol{\Psi}_j\)</span> be the <span class="math inline">\(n \times m_j\)</span> matrix of evaluations of the <span class="math inline">\(\psi_{j\ell}\)</span> and  for <span class="math inline">\(j = 1, \ldots, p\)</span>, i.e., <span class="math inline">\(\boldsymbol{\theta}_j\)</span> is a <span class="math inline">\(m_j\)</span>-dimensional column vector of basis coefficients for the <span class="math inline">\(j\)</span>th main effect. In this article we consider an additive interaction regression model of the form
<span class="math display">\[\begin{align}
Y  &amp; =  \beta_0 \cdot \boldsymbol{1} + \sum_{j=1}^p \boldsymbol{\Psi}_j \boldsymbol{\theta}_j + \beta_E X_E + \sum_{j=1}^p (X_E \circ \boldsymbol{\Psi}_j) \boldsymbol{\alpha}_{j}  + \varepsilon  \label{eq:linpred}
\end{align}\]</span>
where <span class="math inline">\(\beta_0\)</span> is the intercept, <span class="math inline">\(\beta_E\)</span> is the coefficient for the environment variable, <span class="math inline">\(\boldsymbol{\alpha}_j = (\alpha_{j1}, \ldots, \alpha_{jm_j})\in \mathbb{R}^{m_j}\)</span> are the basis coefficients for the <span class="math inline">\(j\)</span>th interaction term and <span class="math inline">\((X_E \circ \boldsymbol{\Psi}_j)\)</span> is the <span class="math inline">\(n \times m_j\)</span> matrix formed by the component-wise multiplication of the column vector <span class="math inline">\(X_E\)</span> by each column of <span class="math inline">\(\boldsymbol{\Psi}_j\)</span>. To enforce the strong heredity property, we reparametrize the coefficients for the interaction terms in~ as <span class="math inline">\(\boldsymbol{\alpha}_{j} = \gamma_{j} \beta_E \boldsymbol{\theta}_j\)</span>:
<span class="math display">\[\begin{align}
Y  &amp; =  \beta_0 \cdot \boldsymbol{1} + \sum_{j=1}^p \boldsymbol{\Psi}_j \boldsymbol{\theta}_j + \beta_E X_E + \sum_{j=1}^p \gamma_{j}  \beta_E (X_E \circ \boldsymbol{\Psi}_j) \boldsymbol{\theta}_j + \varepsilon   \label{eq:linpred2}
\end{align}\]</span>
For a continuous response, we use the squared-error loss:
<span class="math display">\[\begin{equation}
\mathcal{L}(Y;\boldsymbol{\theta}) = \frac{1}{2n}\lVert Y - \beta_0 \cdot \boldsymbol{1} - \sum_{j=1}^p \boldsymbol{\Psi}_j \boldsymbol{\theta}_j - \beta_E X_E - \sum_{j=1}^p \gamma_{j}  \beta_E (X_E \circ \boldsymbol{\Psi}_j) \boldsymbol{\theta}_j \rVert_2^2
\end{equation}\]</span>
<p>where <span class="math inline">\(\boldsymbol{\theta} \equiv (\beta_0, \beta_E,\boldsymbol{\theta}_1, \ldots, \boldsymbol{\theta}_p, \gamma_1, \ldots, \gamma_p)\)</span>.</p>
We consider the following penalized least squares criterion for this problem:
<span class="math display">\[\begin{equation}
\arg\min_{\boldsymbol{\theta} }  \mathcal{L}(Y;\boldsymbol{\theta}) + \lambda (1-\alpha)  \left( w_E |\beta_E| + \sum_{j=1}^{p} w_j \lVert\boldsymbol{\theta}_j \rVert_2 \right) +  \lambda\alpha \sum_{j=1}^{p} w_{jE} |\gamma_{j}| \label{eq:lassolikelihood3}
\end{equation}\]</span>
<p>where <span class="math inline">\(\lambda &gt;0\)</span> and <span class="math inline">\(\alpha \in (0,1)\)</span> are tuning parameters and <span class="math inline">\(w_E, w_j, w_{jE}\)</span> are adaptive weights for <span class="math inline">\(j=1, \ldots, p\)</span>. These weights serve as a way of allowing parameters to be penalized differently.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The package can be installed from <a href="https://github.com/sahirbhatnagar/sail">GitHub</a> via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"pacman"</span>)
pacman<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/pacman/topics/p_load_gh">p_load_gh</a></span>(<span class="st">'sahirbhatnagar/sail'</span>)</code></pre></div>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>We give a quick overview of the main functions and go into details in other vignettes. We will use the simulated data which ships with the package and can be loaded via:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sail)
<span class="kw">data</span>(<span class="st">"sailsim"</span>)
<span class="kw">names</span>(sailsim)
<span class="co">#&gt; [1] "x"        "y"        "e"        "f1"       "f2"       "f3"      </span>
<span class="co">#&gt; [7] "f4"       "f3.inter" "f4.inter"</span></code></pre></div>
<p>We first define a basis expansion. In this example we use cubic bsplines with degree 5.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(splines)
f.basis &lt;-<span class="st"> </span><span class="cf">function</span>(x) splines<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/splines/topics/bs">bs</a></span>(x, <span class="dt">degree =</span> <span class="dv">5</span>)</code></pre></div>
<p>Next we fit the model using the most basic call to <code>sail</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sail.html">sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e, <span class="dt">basis =</span> f.basis)</code></pre></div>
<p><code>fit</code> is an object of class <code>sail</code> that contains all the relevant information of the fitted model including the estimated coefficients at each value of <span class="math inline">\(\lambda\)</span> (by default the program chooses its own decreasing sequence of 100 <span class="math inline">\(\lambda\)</span> values). There are <code>print</code>, <code>plot</code>, <code>coef</code> and <code>predict</code> methods of objects of class <code>sail</code>. The <code>print</code> method outputs the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  sail(x = sailsim$x, y = sailsim$y, e = sailsim$e, basis = f.basis) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      df_main df_interaction df_environment     %Dev  Lambda</span>
<span class="co">#&gt; s1         0              0              0 0.000000 1.48800</span>
<span class="co">#&gt; s2         0              0              1 0.001698 1.42100</span>
<span class="co">#&gt; s3         0              0              1 0.003357 1.35600</span>
<span class="co">#&gt; s4         0              0              1 0.004897 1.29400</span>
<span class="co">#&gt; s5         0              0              1 0.006352 1.23500</span>
<span class="co">#&gt; s6         1              0              1 0.014720 1.17900</span>
<span class="co">#&gt; s7         2              0              1 0.045810 1.12600</span>
<span class="co">#&gt; s8         2              0              1 0.080020 1.07500</span>
<span class="co">#&gt; s9         2              0              1 0.111900 1.02600</span>
<span class="co">#&gt; s10        2              0              1 0.141400 0.97910</span>
<span class="co">#&gt; s11        2              0              1 0.168900 0.93460</span>
<span class="co">#&gt; s12        2              0              1 0.194400 0.89210</span>
<span class="co">#&gt; s13        2              0              1 0.218100 0.85160</span>
<span class="co">#&gt; s14        2              0              1 0.240000 0.81290</span>
<span class="co">#&gt; s15        2              0              1 0.260400 0.77590</span>
<span class="co">#&gt; s16        2              0              1 0.279200 0.74070</span>
<span class="co">#&gt; s17        3              1              1 0.465100 0.70700</span>
<span class="co">#&gt; s18        3              1              1 0.479500 0.67490</span>
<span class="co">#&gt; s19        3              1              1 0.492900 0.64420</span>
<span class="co">#&gt; s20        3              2              1 0.508200 0.61490</span>
<span class="co">#&gt; s21        3              2              1 0.524200 0.58700</span>
<span class="co">#&gt; s22        3              2              1 0.536600 0.56030</span>
<span class="co">#&gt; s23        3              2              1 0.548000 0.53480</span>
<span class="co">#&gt; s24        4              2              1 0.558000 0.51050</span>
<span class="co">#&gt; s25        5              2              1 0.568900 0.48730</span>
<span class="co">#&gt; s26        5              2              1 0.579900 0.46520</span>
<span class="co">#&gt; s27        5              2              1 0.590100 0.44400</span>
<span class="co">#&gt; s28        5              2              1 0.599500 0.42380</span>
<span class="co">#&gt; s29        5              3              1 0.609800 0.40460</span>
<span class="co">#&gt; s30        5              3              1 0.619100 0.38620</span>
<span class="co">#&gt; s31        5              3              1 0.628200 0.36860</span>
<span class="co">#&gt; s32        6              3              1 0.637200 0.35190</span>
<span class="co">#&gt; s33        6              3              1 0.646800 0.33590</span>
<span class="co">#&gt; s34        6              3              1 0.655000 0.32060</span>
<span class="co">#&gt; s35        6              3              1 0.663300 0.30600</span>
<span class="co">#&gt; s36        7              3              1 0.671600 0.29210</span>
<span class="co">#&gt; s37        7              3              1 0.679500 0.27890</span>
<span class="co">#&gt; s38        7              3              1 0.687400 0.26620</span>
<span class="co">#&gt; s39        7              3              1 0.694600 0.25410</span>
<span class="co">#&gt; s40        7              4              1 0.702600 0.24250</span>
<span class="co">#&gt; s41        7              4              1 0.734100 0.23150</span>
<span class="co">#&gt; s42        7              4              1 0.739300 0.22100</span>
<span class="co">#&gt; s43        7              5              1 0.745200 0.21090</span>
<span class="co">#&gt; s44        7              6              1 0.754400 0.20140</span>
<span class="co">#&gt; s45        7              6              1 0.760700 0.19220</span>
<span class="co">#&gt; s46        7              6              1 0.767300 0.18350</span>
<span class="co">#&gt; s47        7              6              1 0.771800 0.17510</span>
<span class="co">#&gt; s48        7              6              1 0.776100 0.16720</span>
<span class="co">#&gt; s49        8              6              1 0.780700 0.15960</span>
<span class="co">#&gt; s50        8              6              1 0.784500 0.15230</span>
<span class="co">#&gt; s51        9              6              1 0.788700 0.14540</span>
<span class="co">#&gt; s52       10              6              1 0.792700 0.13880</span>
<span class="co">#&gt; s53       12              6              1 0.797800 0.13250</span>
<span class="co">#&gt; s54       13              6              1 0.802600 0.12650</span>
<span class="co">#&gt; s55       13              6              1 0.807500 0.12070</span>
<span class="co">#&gt; s56       13              6              1 0.812200 0.11520</span>
<span class="co">#&gt; s57       14              6              1 0.816700 0.11000</span>
<span class="co">#&gt; s58       14              6              1 0.821300 0.10500</span>
<span class="co">#&gt; s59       15              6              1 0.826100 0.10020</span>
<span class="co">#&gt; s60       15              7              1 0.831200 0.09566</span>
<span class="co">#&gt; s61       13             10              1 0.871400 0.09131</span>
<span class="co">#&gt; s62       13             10              1 0.873800 0.08716</span>
<span class="co">#&gt; s63       13             10              1 0.876200 0.08320</span>
<span class="co">#&gt; s64       14             10              1 0.878600 0.07942</span>
<span class="co">#&gt; s65       14             10              1 0.881000 0.07581</span>
<span class="co">#&gt; s66       14             11              1 0.883400 0.07236</span>
<span class="co">#&gt; s67       14             11              1 0.885900 0.06907</span>
<span class="co">#&gt; s68       14             11              1 0.888400 0.06593</span>
<span class="co">#&gt; s69       14             11              1 0.890600 0.06294</span>
<span class="co">#&gt; s70       16             13              1 0.930600 0.06008</span>
<span class="co">#&gt; s71       16             13              1 0.932300 0.05735</span>
<span class="co">#&gt; s72       16             13              1 0.934200 0.05474</span>
<span class="co">#&gt; s73       16             13              1 0.936100 0.05225</span>
<span class="co">#&gt; s74       16             13              1 0.938500 0.04988</span>
<span class="co">#&gt; s75       16             13              1 0.940000 0.04761</span>
<span class="co">#&gt; s76       17             13              1 0.942100 0.04545</span>
<span class="co">#&gt; s77       17             13              1 0.943800 0.04338</span>
<span class="co">#&gt; s78       17             14              1 0.945600 0.04141</span>
<span class="co">#&gt; s79       17             14              1 0.947300 0.03953</span>
<span class="co">#&gt; s80       18             14              1 0.949000 0.03773</span>
<span class="co">#&gt; s81       18             14              1 0.950700 0.03602</span>
<span class="co">#&gt; s82       18             14              1 0.952400 0.03438</span>
<span class="co">#&gt; s83       18             14              1 0.954400 0.03282</span>
<span class="co">#&gt; s84       18             14              1 0.955800 0.03132</span>
<span class="co">#&gt; s85       18             14              1 0.957200 0.02990</span>
<span class="co">#&gt; s86       19             14              1 0.959000 0.02854</span>
<span class="co">#&gt; s87       19             15              1 0.960300 0.02724</span>
<span class="co">#&gt; s88       19             15              1 0.967800 0.02601</span>
<span class="co">#&gt; s89       19             15              1 0.968900 0.02482</span>
<span class="co">#&gt; s90       19             15              1 0.970100 0.02370</span>
<span class="co">#&gt; s91       19             15              1 0.971300 0.02262</span>
<span class="co">#&gt; s92       19             15              1 0.972400 0.02159</span>
<span class="co">#&gt; s93       19             15              1 0.973500 0.02061</span>
<span class="co">#&gt; s94       19             15              1 0.974600 0.01967</span>
<span class="co">#&gt; s95       20             19              1 0.977900 0.01878</span>
<span class="co">#&gt; s96       20             19              1 0.978600 0.01792</span>
<span class="co">#&gt; s97       20             19              1 0.979300 0.01711</span>
<span class="co">#&gt; s98       20             19              1 0.980000 0.01633</span>
<span class="co">#&gt; s99       20             19              1 0.980700 0.01559</span>
<span class="co">#&gt; s100      20             19              1 0.981400 0.01488</span></code></pre></div>
<p>When <code>expand = TRUE</code> (i.e. the user did not provide their own design matrix), the <code>df_main</code> and <code>df_interaction</code> columns correspond to the number of non-zero predictors present in the model before basis expansion. This <strong>does not</strong> correspond to the number of non-zero coefficients in the model, but rather the number of unique variables. In this example we expanded each column of <span class="math inline">\(\mathbf{X}\)</span> to five columns. If <code>df_main=4</code>, <code>df_interaction=2</code> and <code>df_environment=1</code>, then the total number of non-zero coefficients would be <span class="math inline">\(5 \times (4+2) + 1\)</span>.</p>
<p>The entire solution path can be plotted via the <code>plot</code> method for objects of class <code>sail</code>. The y-axis is the value of the coefficient and the x-axis is the <span class="math inline">\(\log(\lambda)\)</span>. Each line represents a coefficient in the model, and each color represents a variable (i.e. in this example a given variable will have 5 lines when it is non-zero). The numbers at the top of the plot represent the number of non-zero variables in the model: top panel (<code>df_main</code> + <code>df_environment</code>), bottom panel (<code>df_interaction</code>). The black line is the coefficient path for the environment variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fit)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The estimated coefficients at each value of lambda is given by (matrix partially printed here for brevity)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">50</span><span class="op">:</span><span class="dv">55</span>]
<span class="co">#&gt; 6 x 6 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                   s50        s51        s52        s53        s54</span>
<span class="co">#&gt; (Intercept)  5.290833  5.2837573  5.2803780  5.2753630  5.2717902</span>
<span class="co">#&gt; X1_1        -0.979303 -0.9604292 -0.9449933 -0.9220866 -0.9171202</span>
<span class="co">#&gt; X1_2         1.690176  1.7893506  1.8923047  1.9950535  2.1040903</span>
<span class="co">#&gt; X1_3         1.646209  1.7048994  1.7722054  1.8250656  1.8950572</span>
<span class="co">#&gt; X1_4         1.522426  1.5433270  1.5662846  1.5853967  1.6101828</span>
<span class="co">#&gt; X1_5         3.338527  3.4182125  3.4907005  3.5762497  3.6632614</span>
<span class="co">#&gt;                    s55</span>
<span class="co">#&gt; (Intercept)  5.2695429</span>
<span class="co">#&gt; X1_1        -0.9270781</span>
<span class="co">#&gt; X1_2         2.2057013</span>
<span class="co">#&gt; X1_3         1.9641879</span>
<span class="co">#&gt; X1_4         1.6321740</span>
<span class="co">#&gt; X1_5         3.7452560</span></code></pre></div>
<p>The predicted response at each value of lambda:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(fit)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">50</span><span class="op">:</span><span class="dv">55</span>]
<span class="co">#&gt;            s50       s51       s52       s53       s54       s55</span>
<span class="co">#&gt; [1,]  6.244760  6.199363  6.185411  6.178014  6.156219  6.124321</span>
<span class="co">#&gt; [2,]  3.002808  2.995389  3.038672  3.079610  3.143616  3.208972</span>
<span class="co">#&gt; [3,]  2.073350  2.043516  2.016354  1.997213  1.966913  1.957284</span>
<span class="co">#&gt; [4,] 13.489022 13.490853 13.361077 13.384407 13.350715 13.324150</span>
<span class="co">#&gt; [5,]  1.225603  1.210385  1.134488  1.156340  1.156697  1.156134</span></code></pre></div>
<p>The predicted response at a specific value of lambda can be specified by the <code>s</code> argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(fit, <span class="dt">s =</span> <span class="fl">0.8</span>)
<span class="co">#&gt;               1</span>
<span class="co">#&gt;   [1,] 5.624232</span>
<span class="co">#&gt;   [2,] 4.940944</span>
<span class="co">#&gt;   [3,] 3.847965</span>
<span class="co">#&gt;   [4,] 6.687777</span>
<span class="co">#&gt;   [5,] 3.058124</span>
<span class="co">#&gt;   [6,] 3.607326</span>
<span class="co">#&gt;   [7,] 6.615916</span>
<span class="co">#&gt;   [8,] 5.032047</span>
<span class="co">#&gt;   [9,] 6.040452</span>
<span class="co">#&gt;  [10,] 5.486751</span>
<span class="co">#&gt;  [11,] 4.765237</span>
<span class="co">#&gt;  [12,] 7.238408</span>
<span class="co">#&gt;  [13,] 7.063706</span>
<span class="co">#&gt;  [14,] 4.590884</span>
<span class="co">#&gt;  [15,] 7.657128</span>
<span class="co">#&gt;  [16,] 4.904077</span>
<span class="co">#&gt;  [17,] 4.195213</span>
<span class="co">#&gt;  [18,] 4.504339</span>
<span class="co">#&gt;  [19,] 4.809399</span>
<span class="co">#&gt;  [20,] 5.615791</span>
<span class="co">#&gt;  [21,] 6.546767</span>
<span class="co">#&gt;  [22,] 5.673886</span>
<span class="co">#&gt;  [23,] 4.631122</span>
<span class="co">#&gt;  [24,] 6.849338</span>
<span class="co">#&gt;  [25,] 4.091877</span>
<span class="co">#&gt;  [26,] 7.020022</span>
<span class="co">#&gt;  [27,] 7.175685</span>
<span class="co">#&gt;  [28,] 3.550668</span>
<span class="co">#&gt;  [29,] 6.737500</span>
<span class="co">#&gt;  [30,] 6.366243</span>
<span class="co">#&gt;  [31,] 5.192395</span>
<span class="co">#&gt;  [32,] 5.384846</span>
<span class="co">#&gt;  [33,] 6.935418</span>
<span class="co">#&gt;  [34,] 4.258696</span>
<span class="co">#&gt;  [35,] 7.603471</span>
<span class="co">#&gt;  [36,] 5.303784</span>
<span class="co">#&gt;  [37,] 5.303826</span>
<span class="co">#&gt;  [38,] 4.285530</span>
<span class="co">#&gt;  [39,] 4.803300</span>
<span class="co">#&gt;  [40,] 5.503811</span>
<span class="co">#&gt;  [41,] 3.620280</span>
<span class="co">#&gt;  [42,] 3.628351</span>
<span class="co">#&gt;  [43,] 5.421528</span>
<span class="co">#&gt;  [44,] 7.492914</span>
<span class="co">#&gt;  [45,] 4.183416</span>
<span class="co">#&gt;  [46,] 4.536360</span>
<span class="co">#&gt;  [47,] 5.348853</span>
<span class="co">#&gt;  [48,] 7.518597</span>
<span class="co">#&gt;  [49,] 4.493770</span>
<span class="co">#&gt;  [50,] 5.276594</span>
<span class="co">#&gt;  [51,] 5.568093</span>
<span class="co">#&gt;  [52,] 4.473407</span>
<span class="co">#&gt;  [53,] 5.563292</span>
<span class="co">#&gt;  [54,] 5.744353</span>
<span class="co">#&gt;  [55,] 4.592868</span>
<span class="co">#&gt;  [56,] 4.307980</span>
<span class="co">#&gt;  [57,] 4.854115</span>
<span class="co">#&gt;  [58,] 5.244134</span>
<span class="co">#&gt;  [59,] 6.736890</span>
<span class="co">#&gt;  [60,] 5.070075</span>
<span class="co">#&gt;  [61,] 4.517567</span>
<span class="co">#&gt;  [62,] 3.129270</span>
<span class="co">#&gt;  [63,] 6.601207</span>
<span class="co">#&gt;  [64,] 4.547151</span>
<span class="co">#&gt;  [65,] 4.566028</span>
<span class="co">#&gt;  [66,] 6.376860</span>
<span class="co">#&gt;  [67,] 4.967343</span>
<span class="co">#&gt;  [68,] 6.138383</span>
<span class="co">#&gt;  [69,] 5.385448</span>
<span class="co">#&gt;  [70,] 6.923559</span>
<span class="co">#&gt;  [71,] 5.015826</span>
<span class="co">#&gt;  [72,] 3.524949</span>
<span class="co">#&gt;  [73,] 5.669353</span>
<span class="co">#&gt;  [74,] 7.044308</span>
<span class="co">#&gt;  [75,] 3.523070</span>
<span class="co">#&gt;  [76,] 4.674963</span>
<span class="co">#&gt;  [77,] 3.396258</span>
<span class="co">#&gt;  [78,] 5.592357</span>
<span class="co">#&gt;  [79,] 5.415423</span>
<span class="co">#&gt;  [80,] 4.810314</span>
<span class="co">#&gt;  [81,] 5.712646</span>
<span class="co">#&gt;  [82,] 5.990818</span>
<span class="co">#&gt;  [83,] 4.861425</span>
<span class="co">#&gt;  [84,] 6.761552</span>
<span class="co">#&gt;  [85,] 5.493592</span>
<span class="co">#&gt;  [86,] 3.607781</span>
<span class="co">#&gt;  [87,] 3.986110</span>
<span class="co">#&gt;  [88,] 4.259476</span>
<span class="co">#&gt;  [89,] 4.174571</span>
<span class="co">#&gt;  [90,] 3.666310</span>
<span class="co">#&gt;  [91,] 5.181711</span>
<span class="co">#&gt;  [92,] 7.086435</span>
<span class="co">#&gt;  [93,] 5.406326</span>
<span class="co">#&gt;  [94,] 6.583031</span>
<span class="co">#&gt;  [95,] 4.664773</span>
<span class="co">#&gt;  [96,] 3.695451</span>
<span class="co">#&gt;  [97,] 5.100857</span>
<span class="co">#&gt;  [98,] 4.984838</span>
<span class="co">#&gt;  [99,] 3.961504</span>
<span class="co">#&gt; [100,] 6.078087</span></code></pre></div>
<p>You can specify more than one value for <code>s</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(fit, <span class="dt">s =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>))
<span class="co">#&gt;               1          2</span>
<span class="co">#&gt;   [1,] 5.624232  6.5230740</span>
<span class="co">#&gt;   [2,] 4.940944  2.9750177</span>
<span class="co">#&gt;   [3,] 3.847965  2.3266980</span>
<span class="co">#&gt;   [4,] 6.687777 13.9562204</span>
<span class="co">#&gt;   [5,] 3.058124  1.5688962</span>
<span class="co">#&gt;   [6,] 3.607326  1.6348912</span>
<span class="co">#&gt;   [7,] 6.615916 13.2009227</span>
<span class="co">#&gt;   [8,] 5.032047  5.9480404</span>
<span class="co">#&gt;   [9,] 6.040452  5.8691675</span>
<span class="co">#&gt;  [10,] 5.486751  5.0987940</span>
<span class="co">#&gt;  [11,] 4.765237  3.5631269</span>
<span class="co">#&gt;  [12,] 7.238408 11.8329816</span>
<span class="co">#&gt;  [13,] 7.063706 12.4826512</span>
<span class="co">#&gt;  [14,] 4.590884  3.9524402</span>
<span class="co">#&gt;  [15,] 7.657128 14.2931482</span>
<span class="co">#&gt;  [16,] 4.904077  5.0900767</span>
<span class="co">#&gt;  [17,] 4.195213 -0.5844299</span>
<span class="co">#&gt;  [18,] 4.504339  4.4666357</span>
<span class="co">#&gt;  [19,] 4.809399  3.0374049</span>
<span class="co">#&gt;  [20,] 5.615791  3.5399188</span>
<span class="co">#&gt;  [21,] 6.546767  8.3512494</span>
<span class="co">#&gt;  [22,] 5.673886  4.7077896</span>
<span class="co">#&gt;  [23,] 4.631122  1.9943630</span>
<span class="co">#&gt;  [24,] 6.849338 10.7983805</span>
<span class="co">#&gt;  [25,] 4.091877  0.9601846</span>
<span class="co">#&gt;  [26,] 7.020022  9.3762352</span>
<span class="co">#&gt;  [27,] 7.175685  8.6775432</span>
<span class="co">#&gt;  [28,] 3.550668 -1.6523278</span>
<span class="co">#&gt;  [29,] 6.737500 13.5513436</span>
<span class="co">#&gt;  [30,] 6.366243  2.2204467</span>
<span class="co">#&gt;  [31,] 5.192395  5.8213763</span>
<span class="co">#&gt;  [32,] 5.384846  7.4511268</span>
<span class="co">#&gt;  [33,] 6.935418  9.0277752</span>
<span class="co">#&gt;  [34,] 4.258696  4.5323823</span>
<span class="co">#&gt;  [35,] 7.603471 16.3907390</span>
<span class="co">#&gt;  [36,] 5.303784  0.1377432</span>
<span class="co">#&gt;  [37,] 5.303826  5.6261096</span>
<span class="co">#&gt;  [38,] 4.285530  2.3206999</span>
<span class="co">#&gt;  [39,] 4.803300  3.8195444</span>
<span class="co">#&gt;  [40,] 5.503811  4.8408086</span>
<span class="co">#&gt;  [41,] 3.620280  2.4050059</span>
<span class="co">#&gt;  [42,] 3.628351  0.4144305</span>
<span class="co">#&gt;  [43,] 5.421528  6.4970752</span>
<span class="co">#&gt;  [44,] 7.492914 15.6998648</span>
<span class="co">#&gt;  [45,] 4.183416  3.1368088</span>
<span class="co">#&gt;  [46,] 4.536360  3.5137943</span>
<span class="co">#&gt;  [47,] 5.348853  4.4711267</span>
<span class="co">#&gt;  [48,] 7.518597 18.0122252</span>
<span class="co">#&gt;  [49,] 4.493770  2.3526655</span>
<span class="co">#&gt;  [50,] 5.276594  7.4618284</span>
<span class="co">#&gt;  [51,] 5.568093  5.9679862</span>
<span class="co">#&gt;  [52,] 4.473407  1.7229550</span>
<span class="co">#&gt;  [53,] 5.563292  7.3990744</span>
<span class="co">#&gt;  [54,] 5.744353  8.6534271</span>
<span class="co">#&gt;  [55,] 4.592868  2.0907568</span>
<span class="co">#&gt;  [56,] 4.307980  0.7927840</span>
<span class="co">#&gt;  [57,] 4.854115  5.3436578</span>
<span class="co">#&gt;  [58,] 5.244134  9.2910545</span>
<span class="co">#&gt;  [59,] 6.736890  9.7709887</span>
<span class="co">#&gt;  [60,] 5.070075  1.6897955</span>
<span class="co">#&gt;  [61,] 4.517567  1.4507809</span>
<span class="co">#&gt;  [62,] 3.129270 -0.9532221</span>
<span class="co">#&gt;  [63,] 6.601207  8.1123225</span>
<span class="co">#&gt;  [64,] 4.547151  1.3003285</span>
<span class="co">#&gt;  [65,] 4.566028  3.1206603</span>
<span class="co">#&gt;  [66,] 6.376860  3.5765440</span>
<span class="co">#&gt;  [67,] 4.967343  4.8268433</span>
<span class="co">#&gt;  [68,] 6.138383  6.1849972</span>
<span class="co">#&gt;  [69,] 5.385448 10.1092482</span>
<span class="co">#&gt;  [70,] 6.923559  8.2999571</span>
<span class="co">#&gt;  [71,] 5.015826  4.0040478</span>
<span class="co">#&gt;  [72,] 3.524949  1.3597820</span>
<span class="co">#&gt;  [73,] 5.669353  6.7846103</span>
<span class="co">#&gt;  [74,] 7.044308  4.5323126</span>
<span class="co">#&gt;  [75,] 3.523070  2.6555577</span>
<span class="co">#&gt;  [76,] 4.674963  1.1032379</span>
<span class="co">#&gt;  [77,] 3.396258  1.8733145</span>
<span class="co">#&gt;  [78,] 5.592357 13.3777530</span>
<span class="co">#&gt;  [79,] 5.415423  6.6235012</span>
<span class="co">#&gt;  [80,] 4.810314  2.9584783</span>
<span class="co">#&gt;  [81,] 5.712646  4.0235765</span>
<span class="co">#&gt;  [82,] 5.990818  4.9867095</span>
<span class="co">#&gt;  [83,] 4.861425  4.5053610</span>
<span class="co">#&gt;  [84,] 6.761552  5.9701019</span>
<span class="co">#&gt;  [85,] 5.493592  4.8052874</span>
<span class="co">#&gt;  [86,] 3.607781  1.8020652</span>
<span class="co">#&gt;  [87,] 3.986110  3.4415117</span>
<span class="co">#&gt;  [88,] 4.259476  0.7337290</span>
<span class="co">#&gt;  [89,] 4.174571  4.3173319</span>
<span class="co">#&gt;  [90,] 3.666310  5.4733594</span>
<span class="co">#&gt;  [91,] 5.181711  8.2829841</span>
<span class="co">#&gt;  [92,] 7.086435 10.2504954</span>
<span class="co">#&gt;  [93,] 5.406326  5.2240663</span>
<span class="co">#&gt;  [94,] 6.583031  7.7020652</span>
<span class="co">#&gt;  [95,] 4.664773  5.3974401</span>
<span class="co">#&gt;  [96,] 3.695451  2.1516883</span>
<span class="co">#&gt;  [97,] 5.100857  9.2733043</span>
<span class="co">#&gt;  [98,] 4.984838  6.5142889</span>
<span class="co">#&gt;  [99,] 3.961504  3.3387104</span>
<span class="co">#&gt; [100,] 6.078087  4.9794667</span></code></pre></div>
<p>You can also extract a list of active variables (i.e. variables with a non-zero estimated coefficient) for each value of lambda:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit[[<span class="st">"active"</span>]]
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; character(0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] "E"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] "E"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] "E"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1] "E"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt; [1] "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[7]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[8]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[9]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[10]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[11]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[12]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[13]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[14]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[15]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[16]]</span>
<span class="co">#&gt; [1] "X3" "X4" "E" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[17]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[18]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[19]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[20]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[21]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[22]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[23]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[24]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[25]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X11"  "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[26]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X11"  "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[27]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X11"  "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[28]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X11"  "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[29]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X11"  "X1:E" "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[30]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X11"  "X1:E" "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[31]]</span>
<span class="co">#&gt; [1] "X1"   "X3"   "X4"   "X8"   "X11"  "X1:E" "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[32]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X1:E" "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[33]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X1:E" "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[34]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X1:E" "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[35]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X1:E" "X3:E" "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[36]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X3:E" "X4:E"</span>
<span class="co">#&gt; [11] "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[37]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X3:E" "X4:E"</span>
<span class="co">#&gt; [11] "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[38]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X3:E" "X4:E"</span>
<span class="co">#&gt; [11] "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[39]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X3:E" "X4:E"</span>
<span class="co">#&gt; [11] "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[40]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X2:E" "X3:E"</span>
<span class="co">#&gt; [11] "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[41]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X2:E" "X3:E"</span>
<span class="co">#&gt; [11] "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[42]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X2:E" "X3:E"</span>
<span class="co">#&gt; [11] "X4:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[43]]</span>
<span class="co">#&gt;  [1] "X1"   "X2"   "X3"   "X4"   "X8"   "X11"  "X20"  "X1:E" "X2:E" "X3:E"</span>
<span class="co">#&gt; [11] "X4:E" "X8:E" "E"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[44]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X8"    "X11"   "X20"   "X1:E" </span>
<span class="co">#&gt;  [9] "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[45]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X8"    "X11"   "X20"   "X1:E" </span>
<span class="co">#&gt;  [9] "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[46]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X8"    "X11"   "X20"   "X1:E" </span>
<span class="co">#&gt;  [9] "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[47]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X8"    "X11"   "X20"   "X1:E" </span>
<span class="co">#&gt;  [9] "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[48]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X8"    "X11"   "X20"   "X1:E" </span>
<span class="co">#&gt;  [9] "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[49]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X8"    "X10"   "X11"   "X20"  </span>
<span class="co">#&gt;  [9] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[50]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X8"    "X10"   "X11"   "X20"  </span>
<span class="co">#&gt;  [9] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[51]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X6"    "X8"    "X10"   "X11"  </span>
<span class="co">#&gt;  [9] "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[52]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X6"    "X8"    "X10"   "X11"  </span>
<span class="co">#&gt;  [9] "X16"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E"</span>
<span class="co">#&gt; [17] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[53]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X6"    "X8"    "X10"   "X11"  </span>
<span class="co">#&gt;  [9] "X15"   "X16"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E" </span>
<span class="co">#&gt; [17] "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[54]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X10"  </span>
<span class="co">#&gt;  [9] "X11"   "X15"   "X16"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E" </span>
<span class="co">#&gt; [17] "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[55]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X10"  </span>
<span class="co">#&gt;  [9] "X11"   "X15"   "X16"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E" </span>
<span class="co">#&gt; [17] "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[56]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X10"  </span>
<span class="co">#&gt;  [9] "X11"   "X15"   "X16"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E" </span>
<span class="co">#&gt; [17] "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[57]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X10"  </span>
<span class="co">#&gt;  [9] "X11"   "X14"   "X15"   "X16"   "X19"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[58]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X10"  </span>
<span class="co">#&gt;  [9] "X11"   "X14"   "X15"   "X16"   "X19"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[59]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X10"  </span>
<span class="co">#&gt;  [9] "X11"   "X14"   "X15"   "X16"   "X17"   "X19"   "X20"   "X1:E" </span>
<span class="co">#&gt; [17] "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[60]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X10"  </span>
<span class="co">#&gt;  [9] "X11"   "X14"   "X15"   "X16"   "X17"   "X19"   "X20"   "X1:E" </span>
<span class="co">#&gt; [17] "X2:E"  "X3:E"  "X4:E"  "X8:E"  "X11:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[61]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X15"   "X16"   "X20"   "X1:E"  "X2:E"  "X3:E" </span>
<span class="co">#&gt; [17] "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[62]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X15"   "X16"   "X20"   "X1:E"  "X2:E"  "X3:E" </span>
<span class="co">#&gt; [17] "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[63]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X15"   "X16"   "X20"   "X1:E"  "X2:E"  "X3:E" </span>
<span class="co">#&gt; [17] "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[64]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X15"   "X16"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E"</span>
<span class="co">#&gt; [25] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[65]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X15"   "X16"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E"</span>
<span class="co">#&gt; [25] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[66]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X15"   "X16"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E"</span>
<span class="co">#&gt; [25] "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[67]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X15"   "X16"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E"</span>
<span class="co">#&gt; [25] "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[68]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X15"   "X16"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E"</span>
<span class="co">#&gt; [25] "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[69]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X15"   "X16"   "X20"   "X1:E"  "X2:E" </span>
<span class="co">#&gt; [17] "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E"  "X11:E" "X16:E"</span>
<span class="co">#&gt; [25] "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[70]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"   "X20"  </span>
<span class="co">#&gt; [17] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E" </span>
<span class="co">#&gt; [25] "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[71]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"   "X20"  </span>
<span class="co">#&gt; [17] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E" </span>
<span class="co">#&gt; [25] "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[72]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"   "X20"  </span>
<span class="co">#&gt; [17] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E" </span>
<span class="co">#&gt; [25] "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[73]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"   "X20"  </span>
<span class="co">#&gt; [17] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E" </span>
<span class="co">#&gt; [25] "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[74]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"   "X20"  </span>
<span class="co">#&gt; [17] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E" </span>
<span class="co">#&gt; [25] "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[75]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X8"    "X9"   </span>
<span class="co">#&gt;  [9] "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"   "X20"  </span>
<span class="co">#&gt; [17] "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E"  "X9:E" </span>
<span class="co">#&gt; [25] "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[76]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E" </span>
<span class="co">#&gt; [25] "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[77]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E" </span>
<span class="co">#&gt; [25] "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[78]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E" </span>
<span class="co">#&gt; [25] "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[79]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E"  "X8:E" </span>
<span class="co">#&gt; [25] "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[80]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E" </span>
<span class="co">#&gt; [25] "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E"</span>
<span class="co">#&gt; [33] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[81]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E" </span>
<span class="co">#&gt; [25] "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E"</span>
<span class="co">#&gt; [33] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[82]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E" </span>
<span class="co">#&gt; [25] "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E"</span>
<span class="co">#&gt; [33] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[83]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E" </span>
<span class="co">#&gt; [25] "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E"</span>
<span class="co">#&gt; [33] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[84]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E" </span>
<span class="co">#&gt; [25] "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E"</span>
<span class="co">#&gt; [33] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[85]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X14"   "X15"   "X16"   "X18"  </span>
<span class="co">#&gt; [17] "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E"  "X6:E" </span>
<span class="co">#&gt; [25] "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E" "X20:E"</span>
<span class="co">#&gt; [33] "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[86]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E" "X16:E"</span>
<span class="co">#&gt; [33] "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[87]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[88]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[89]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[90]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[91]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[92]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[93]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[94]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E"  "X5:E" </span>
<span class="co">#&gt; [25] "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X11:E" "X12:E" "X14:E" "X15:E"</span>
<span class="co">#&gt; [33] "X16:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[95]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X17"   "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E" </span>
<span class="co">#&gt; [25] "X5:E"  "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X10:E" "X11:E" "X12:E"</span>
<span class="co">#&gt; [33] "X13:E" "X14:E" "X15:E" "X16:E" "X18:E" "X19:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[96]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X17"   "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E" </span>
<span class="co">#&gt; [25] "X5:E"  "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X10:E" "X11:E" "X12:E"</span>
<span class="co">#&gt; [33] "X13:E" "X14:E" "X15:E" "X16:E" "X18:E" "X19:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[97]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X17"   "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E" </span>
<span class="co">#&gt; [25] "X5:E"  "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X10:E" "X11:E" "X12:E"</span>
<span class="co">#&gt; [33] "X13:E" "X14:E" "X15:E" "X16:E" "X18:E" "X19:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[98]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X17"   "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E" </span>
<span class="co">#&gt; [25] "X5:E"  "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X10:E" "X11:E" "X12:E"</span>
<span class="co">#&gt; [33] "X13:E" "X14:E" "X15:E" "X16:E" "X18:E" "X19:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[99]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X17"   "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E" </span>
<span class="co">#&gt; [25] "X5:E"  "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X10:E" "X11:E" "X12:E"</span>
<span class="co">#&gt; [33] "X13:E" "X14:E" "X15:E" "X16:E" "X18:E" "X19:E" "X20:E" "E"    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[100]]</span>
<span class="co">#&gt;  [1] "X1"    "X2"    "X3"    "X4"    "X5"    "X6"    "X7"    "X8"   </span>
<span class="co">#&gt;  [9] "X9"    "X10"   "X11"   "X12"   "X13"   "X14"   "X15"   "X16"  </span>
<span class="co">#&gt; [17] "X17"   "X18"   "X19"   "X20"   "X1:E"  "X2:E"  "X3:E"  "X4:E" </span>
<span class="co">#&gt; [25] "X5:E"  "X6:E"  "X7:E"  "X8:E"  "X9:E"  "X10:E" "X11:E" "X12:E"</span>
<span class="co">#&gt; [33] "X13:E" "X14:E" "X15:E" "X16:E" "X18:E" "X19:E" "X20:E" "E"</span></code></pre></div>
</div>
<div id="cross-validation" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-validation" class="anchor"></a>Cross-Validation</h2>
<p><code>cv.sail</code> is the main function to do cross-validation along with <code>plot</code>, <code>predict</code>, and <code>coef</code> methods for objects of class <code>cv.sail</code>. We run it in parallel:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">432</span>) <span class="co"># to reproduce results (randomness due to CV folds)</span>
<span class="kw">library</span>(doMC)
<span class="co">#&gt; Loading required package: foreach</span>
<span class="co">#&gt; Loading required package: iterators</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/doMC/topics/registerDoMC">registerDoMC</a></span>(<span class="dt">cores =</span> <span class="dv">2</span>) 
cvfit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cv.sail.html">cv.sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e, <span class="dt">basis =</span> f.basis,
                 <span class="dt">nfolds =</span> <span class="dv">5</span>, <span class="dt">parallel =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>We plot the cross-validated error curve which has the mean-squared error on the y-axis and <span class="math inline">\(\log(\lambda)\)</span> on the x-axis. It includes the cross-validation curve (red dotted line), and upper and lower standard deviation curves along the <span class="math inline">\(\lambda\)</span> sequence (error bars). Two selected <span class="math inline">\(\lambda\)</span>’s are indicated by the vertical dotted lines (see below). The numbers at the top of the plot represent the total number of non-zero variables at that value of <span class="math inline">\(\lambda\)</span> (<code>df_main</code> + <code>df_environment</code> + <code>df_interaction</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cvfit)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p><code>lambda.min</code> is the value of <span class="math inline">\(\lambda\)</span> that gives minimum mean cross-validated error. The other <span class="math inline">\(\lambda\)</span> saved is <code>lambda.1se</code>, which gives the most regularized model such that error is within one standard error of the minimum. We can view the selected <span class="math inline">\(\lambda\)</span>’s and the corresponding coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvfit[[<span class="st">"lambda.min"</span>]]
<span class="co">#&gt; [1] 0.2788543</span>
cvfit[[<span class="st">"lambda.1se"</span>]]
<span class="co">#&gt; [1] 0.4238337</span></code></pre></div>
<p>The estimated coefficients at <code>lambda.1se</code> and <code>lambda.min</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(<span class="kw">coef</span>(cvfit, <span class="dt">s=</span><span class="st">"lambda.1se"</span>), <span class="co"># lambda.1se is the default</span>
<span class="kw">coef</span>(cvfit, <span class="dt">s =</span> <span class="st">"lambda.min"</span>))
<span class="co">#&gt; 202 x 2 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                        1            1</span>
<span class="co">#&gt; (Intercept)   5.42162243   5.43619701</span>
<span class="co">#&gt; X1_1         -0.78253656  -1.23830516</span>
<span class="co">#&gt; X1_2          0.13429262   0.48732240</span>
<span class="co">#&gt; X1_3          0.43865579   0.88911732</span>
<span class="co">#&gt; X1_4          0.79446840   1.10810480</span>
<span class="co">#&gt; X1_5          1.92178800   2.68114985</span>
<span class="co">#&gt; X2_1          .           -0.21979939</span>
<span class="co">#&gt; X2_2          .           -0.95046682</span>
<span class="co">#&gt; X2_3          .           -0.76046594</span>
<span class="co">#&gt; X2_4          .           -0.17408785</span>
<span class="co">#&gt; X2_5          .           -0.06842359</span>
<span class="co">#&gt; X3_1          3.45105131   4.42740541</span>
<span class="co">#&gt; X3_2          1.56761411   2.28691047</span>
<span class="co">#&gt; X3_3         -1.27174989  -1.36817236</span>
<span class="co">#&gt; X3_4         -2.27784639  -2.56642476</span>
<span class="co">#&gt; X3_5         -1.23352658  -1.03097615</span>
<span class="co">#&gt; X4_1          4.47171678   5.37947206</span>
<span class="co">#&gt; X4_2         -2.87477819  -3.35562770</span>
<span class="co">#&gt; X4_3         -6.65050142  -8.07333662</span>
<span class="co">#&gt; X4_4         -3.44081136  -3.50308509</span>
<span class="co">#&gt; X4_5         -0.47029997  -0.55029116</span>
<span class="co">#&gt; X5_1          .            .         </span>
<span class="co">#&gt; X5_2          .            .         </span>
<span class="co">#&gt; X5_3          .            .         </span>
<span class="co">#&gt; X5_4          .            .         </span>
<span class="co">#&gt; X5_5          .            .         </span>
<span class="co">#&gt; X6_1          .            .         </span>
<span class="co">#&gt; X6_2          .            .         </span>
<span class="co">#&gt; X6_3          .            .         </span>
<span class="co">#&gt; X6_4          .            .         </span>
<span class="co">#&gt; X6_5          .            .         </span>
<span class="co">#&gt; X7_1          .            .         </span>
<span class="co">#&gt; X7_2          .            .         </span>
<span class="co">#&gt; X7_3          .            .         </span>
<span class="co">#&gt; X7_4          .            .         </span>
<span class="co">#&gt; X7_5          .            .         </span>
<span class="co">#&gt; X8_1          0.17501411   0.47920984</span>
<span class="co">#&gt; X8_2          0.11615654   0.33988638</span>
<span class="co">#&gt; X8_3          0.01782976   0.07650873</span>
<span class="co">#&gt; X8_4         -0.10502457  -0.28112125</span>
<span class="co">#&gt; X8_5         -0.24477578  -0.66610209</span>
<span class="co">#&gt; X9_1          .            .         </span>
<span class="co">#&gt; X9_2          .            .         </span>
<span class="co">#&gt; X9_3          .            .         </span>
<span class="co">#&gt; X9_4          .            .         </span>
<span class="co">#&gt; X9_5          .            .         </span>
<span class="co">#&gt; X10_1         .            .         </span>
<span class="co">#&gt; X10_2         .            .         </span>
<span class="co">#&gt; X10_3         .            .         </span>
<span class="co">#&gt; X10_4         .            .         </span>
<span class="co">#&gt; X10_5         .            .         </span>
<span class="co">#&gt; X11_1         0.13685648   0.34767475</span>
<span class="co">#&gt; X11_2         0.02857112   0.06273705</span>
<span class="co">#&gt; X11_3        -0.07321859  -0.20148715</span>
<span class="co">#&gt; X11_4        -0.20935470  -0.67854244</span>
<span class="co">#&gt; X11_5        -0.22638940  -0.69583368</span>
<span class="co">#&gt; X12_1         .            .         </span>
<span class="co">#&gt; X12_2         .            .         </span>
<span class="co">#&gt; X12_3         .            .         </span>
<span class="co">#&gt; X12_4         .            .         </span>
<span class="co">#&gt; X12_5         .            .         </span>
<span class="co">#&gt; X13_1         .            .         </span>
<span class="co">#&gt; X13_2         .            .         </span>
<span class="co">#&gt; X13_3         .            .         </span>
<span class="co">#&gt; X13_4         .            .         </span>
<span class="co">#&gt; X13_5         .            .         </span>
<span class="co">#&gt; X14_1         .            .         </span>
<span class="co">#&gt; X14_2         .            .         </span>
<span class="co">#&gt; X14_3         .            .         </span>
<span class="co">#&gt; X14_4         .            .         </span>
<span class="co">#&gt; X14_5         .            .         </span>
<span class="co">#&gt; X15_1         .            .         </span>
<span class="co">#&gt; X15_2         .            .         </span>
<span class="co">#&gt; X15_3         .            .         </span>
<span class="co">#&gt; X15_4         .            .         </span>
<span class="co">#&gt; X15_5         .            .         </span>
<span class="co">#&gt; X16_1         .            .         </span>
<span class="co">#&gt; X16_2         .            .         </span>
<span class="co">#&gt; X16_3         .            .         </span>
<span class="co">#&gt; X16_4         .            .         </span>
<span class="co">#&gt; X16_5         .            .         </span>
<span class="co">#&gt; X17_1         .            .         </span>
<span class="co">#&gt; X17_2         .            .         </span>
<span class="co">#&gt; X17_3         .            .         </span>
<span class="co">#&gt; X17_4         .            .         </span>
<span class="co">#&gt; X17_5         .            .         </span>
<span class="co">#&gt; X18_1         .            .         </span>
<span class="co">#&gt; X18_2         .            .         </span>
<span class="co">#&gt; X18_3         .            .         </span>
<span class="co">#&gt; X18_4         .            .         </span>
<span class="co">#&gt; X18_5         .            .         </span>
<span class="co">#&gt; X19_1         .            .         </span>
<span class="co">#&gt; X19_2         .            .         </span>
<span class="co">#&gt; X19_3         .            .         </span>
<span class="co">#&gt; X19_4         .            .         </span>
<span class="co">#&gt; X19_5         .            .         </span>
<span class="co">#&gt; X20_1         .            0.10215979</span>
<span class="co">#&gt; X20_2         .           -0.03829014</span>
<span class="co">#&gt; X20_3         .           -0.17766509</span>
<span class="co">#&gt; X20_4         .           -0.18547953</span>
<span class="co">#&gt; X20_5         .            0.09733455</span>
<span class="co">#&gt; E             1.99574559   2.06409655</span>
<span class="co">#&gt; X1_1:E        .           -0.53455653</span>
<span class="co">#&gt; X1_2:E        .            0.21036928</span>
<span class="co">#&gt; X1_3:E        .            0.38381772</span>
<span class="co">#&gt; X1_4:E        .            0.47835111</span>
<span class="co">#&gt; X1_5:E        .            1.15740950</span>
<span class="co">#&gt; X2_1:E        .            .         </span>
<span class="co">#&gt; X2_2:E        .            .         </span>
<span class="co">#&gt; X2_3:E        .            .         </span>
<span class="co">#&gt; X2_4:E        .            .         </span>
<span class="co">#&gt; X2_5:E        .            .         </span>
<span class="co">#&gt; X3_1:E        1.80698510   2.37991172</span>
<span class="co">#&gt; X3_2:E        0.82080940   1.22930803</span>
<span class="co">#&gt; X3_3:E       -0.66589363  -0.73544867</span>
<span class="co">#&gt; X3_4:E       -1.19269003  -1.37955841</span>
<span class="co">#&gt; X3_5:E       -0.64587975  -0.55419190</span>
<span class="co">#&gt; X4_1:E        8.31246506   8.87335933</span>
<span class="co">#&gt; X4_2:E       -5.34391922  -5.53505808</span>
<span class="co">#&gt; X4_3:E      -12.36260331 -13.31684893</span>
<span class="co">#&gt; X4_4:E       -6.39611711  -5.77828687</span>
<span class="co">#&gt; X4_5:E       -0.87423964  -0.90769710</span>
<span class="co">#&gt; X5_1:E        .            .         </span>
<span class="co">#&gt; X5_2:E        .            .         </span>
<span class="co">#&gt; X5_3:E        .            .         </span>
<span class="co">#&gt; X5_4:E        .            .         </span>
<span class="co">#&gt; X5_5:E        .            .         </span>
<span class="co">#&gt; X6_1:E        .            .         </span>
<span class="co">#&gt; X6_2:E        .            .         </span>
<span class="co">#&gt; X6_3:E        .            .         </span>
<span class="co">#&gt; X6_4:E        .            .         </span>
<span class="co">#&gt; X6_5:E        .            .         </span>
<span class="co">#&gt; X7_1:E        .            .         </span>
<span class="co">#&gt; X7_2:E        .            .         </span>
<span class="co">#&gt; X7_3:E        .            .         </span>
<span class="co">#&gt; X7_4:E        .            .         </span>
<span class="co">#&gt; X7_5:E        .            .         </span>
<span class="co">#&gt; X8_1:E        .            .         </span>
<span class="co">#&gt; X8_2:E        .            .         </span>
<span class="co">#&gt; X8_3:E        .            .         </span>
<span class="co">#&gt; X8_4:E        .            .         </span>
<span class="co">#&gt; X8_5:E        .            .         </span>
<span class="co">#&gt; X9_1:E        .            .         </span>
<span class="co">#&gt; X9_2:E        .            .         </span>
<span class="co">#&gt; X9_3:E        .            .         </span>
<span class="co">#&gt; X9_4:E        .            .         </span>
<span class="co">#&gt; X9_5:E        .            .         </span>
<span class="co">#&gt; X10_1:E       .            .         </span>
<span class="co">#&gt; X10_2:E       .            .         </span>
<span class="co">#&gt; X10_3:E       .            .         </span>
<span class="co">#&gt; X10_4:E       .            .         </span>
<span class="co">#&gt; X10_5:E       .            .         </span>
<span class="co">#&gt; X11_1:E       .            .         </span>
<span class="co">#&gt; X11_2:E       .            .         </span>
<span class="co">#&gt; X11_3:E       .            .         </span>
<span class="co">#&gt; X11_4:E       .            .         </span>
<span class="co">#&gt; X11_5:E       .            .         </span>
<span class="co">#&gt; X12_1:E       .            .         </span>
<span class="co">#&gt; X12_2:E       .            .         </span>
<span class="co">#&gt; X12_3:E       .            .         </span>
<span class="co">#&gt; X12_4:E       .            .         </span>
<span class="co">#&gt; X12_5:E       .            .         </span>
<span class="co">#&gt; X13_1:E       .            .         </span>
<span class="co">#&gt; X13_2:E       .            .         </span>
<span class="co">#&gt; X13_3:E       .            .         </span>
<span class="co">#&gt; X13_4:E       .            .         </span>
<span class="co">#&gt; X13_5:E       .            .         </span>
<span class="co">#&gt; X14_1:E       .            .         </span>
<span class="co">#&gt; X14_2:E       .            .         </span>
<span class="co">#&gt; X14_3:E       .            .         </span>
<span class="co">#&gt; X14_4:E       .            .         </span>
<span class="co">#&gt; X14_5:E       .            .         </span>
<span class="co">#&gt; X15_1:E       .            .         </span>
<span class="co">#&gt; X15_2:E       .            .         </span>
<span class="co">#&gt; X15_3:E       .            .         </span>
<span class="co">#&gt; X15_4:E       .            .         </span>
<span class="co">#&gt; X15_5:E       .            .         </span>
<span class="co">#&gt; X16_1:E       .            .         </span>
<span class="co">#&gt; X16_2:E       .            .         </span>
<span class="co">#&gt; X16_3:E       .            .         </span>
<span class="co">#&gt; X16_4:E       .            .         </span>
<span class="co">#&gt; X16_5:E       .            .         </span>
<span class="co">#&gt; X17_1:E       .            .         </span>
<span class="co">#&gt; X17_2:E       .            .         </span>
<span class="co">#&gt; X17_3:E       .            .         </span>
<span class="co">#&gt; X17_4:E       .            .         </span>
<span class="co">#&gt; X17_5:E       .            .         </span>
<span class="co">#&gt; X18_1:E       .            .         </span>
<span class="co">#&gt; X18_2:E       .            .         </span>
<span class="co">#&gt; X18_3:E       .            .         </span>
<span class="co">#&gt; X18_4:E       .            .         </span>
<span class="co">#&gt; X18_5:E       .            .         </span>
<span class="co">#&gt; X19_1:E       .            .         </span>
<span class="co">#&gt; X19_2:E       .            .         </span>
<span class="co">#&gt; X19_3:E       .            .         </span>
<span class="co">#&gt; X19_4:E       .            .         </span>
<span class="co">#&gt; X19_5:E       .            .         </span>
<span class="co">#&gt; X20_1:E       .            .         </span>
<span class="co">#&gt; X20_2:E       .            .         </span>
<span class="co">#&gt; X20_3:E       .            .         </span>
<span class="co">#&gt; X20_4:E       .            .         </span>
<span class="co">#&gt; X20_5:E       .            .</span></code></pre></div>
<p>Estimated non-zero coefficients at <code>lambda.1se</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(cvfit, <span class="dt">type =</span> <span class="st">"nonzero"</span>)
<span class="co">#&gt;                        1</span>
<span class="co">#&gt; (Intercept)   5.42162243</span>
<span class="co">#&gt; X1_1         -0.78253656</span>
<span class="co">#&gt; X1_2          0.13429262</span>
<span class="co">#&gt; X1_3          0.43865579</span>
<span class="co">#&gt; X1_4          0.79446840</span>
<span class="co">#&gt; X1_5          1.92178800</span>
<span class="co">#&gt; X3_1          3.45105131</span>
<span class="co">#&gt; X3_2          1.56761411</span>
<span class="co">#&gt; X3_3         -1.27174989</span>
<span class="co">#&gt; X3_4         -2.27784639</span>
<span class="co">#&gt; X3_5         -1.23352658</span>
<span class="co">#&gt; X4_1          4.47171678</span>
<span class="co">#&gt; X4_2         -2.87477819</span>
<span class="co">#&gt; X4_3         -6.65050142</span>
<span class="co">#&gt; X4_4         -3.44081136</span>
<span class="co">#&gt; X4_5         -0.47029997</span>
<span class="co">#&gt; X8_1          0.17501411</span>
<span class="co">#&gt; X8_2          0.11615654</span>
<span class="co">#&gt; X8_3          0.01782976</span>
<span class="co">#&gt; X8_4         -0.10502457</span>
<span class="co">#&gt; X8_5         -0.24477578</span>
<span class="co">#&gt; X11_1         0.13685648</span>
<span class="co">#&gt; X11_2         0.02857112</span>
<span class="co">#&gt; X11_3        -0.07321859</span>
<span class="co">#&gt; X11_4        -0.20935470</span>
<span class="co">#&gt; X11_5        -0.22638940</span>
<span class="co">#&gt; E             1.99574559</span>
<span class="co">#&gt; X3_1:E        1.80698510</span>
<span class="co">#&gt; X3_2:E        0.82080940</span>
<span class="co">#&gt; X3_3:E       -0.66589363</span>
<span class="co">#&gt; X3_4:E       -1.19269003</span>
<span class="co">#&gt; X3_5:E       -0.64587975</span>
<span class="co">#&gt; X4_1:E        8.31246506</span>
<span class="co">#&gt; X4_2:E       -5.34391922</span>
<span class="co">#&gt; X4_3:E      -12.36260331</span>
<span class="co">#&gt; X4_4:E       -6.39611711</span>
<span class="co">#&gt; X4_5:E       -0.87423964</span></code></pre></div>
</div>
<div id="visualizing-the-effect-of-the-non-linear-terms" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-effect-of-the-non-linear-terms" class="anchor"></a>Visualizing the Effect of the Non-linear Terms</h2>
<p>bsplines are difficult to interpret. We provide a plotting function to visualize the effect of the non-linear function on the response.</p>
<div id="main-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#main-effects" class="anchor"></a>Main Effects</h3>
<p>Since we are using simulated data, we also plot the true curve:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotMain.html">plotMain</a></span>(cvfit<span class="op">$</span>sail.fit, <span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">xvar =</span> <span class="st">"X3"</span>,
         <span class="dt">legend.position =</span> <span class="st">"topright"</span>,
         <span class="dt">s =</span> cvfit<span class="op">$</span>lambda.min, <span class="dt">f.truth =</span> sailsim<span class="op">$</span>f3)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div id="interaction-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#interaction-effects" class="anchor"></a>Interaction Effects</h3>
<p>Again, since we are using simulated data, we also plot the true interaction:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotInter.html">plotInter</a></span>(cvfit<span class="op">$</span>sail.fit, <span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">xvar =</span> <span class="st">"X4"</span>,
          <span class="dt">f.truth =</span> sailsim<span class="op">$</span>f4.inter,
          <span class="dt">s =</span> cvfit<span class="op">$</span>lambda.min,
          <span class="dt">title_z =</span> <span class="st">"Estimated"</span>)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-18-1.png" width="768"></p>
</div>
</div>
<div id="linear-interactions" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-interactions" class="anchor"></a>Linear Interactions</h2>
<p>The <code>basis</code> argument in the <code>sail</code> function is very flexible in that it allows you to apply <strong>any</strong> basis expansion to the columns of <span class="math inline">\(\mathbf{X}\)</span>. Of course, there might be situations where you do not expect any non-linear main effects or interactions to be present in your data. You can still use the <code>sail</code> method to search for <strong>linear</strong> main effects and interactions. This can be accomplished by specifying an identity map:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f.identity &lt;-<span class="st"> </span><span class="cf">function</span>(i) i</code></pre></div>
<p>We then pass this function to <code>basis</code> argument in <code>cv.sail</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvfit_linear &lt;-<span class="st"> </span><span class="kw"><a href="../reference/cv.sail.html">cv.sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e,
                        <span class="dt">basis =</span> f.identity, <span class="dt">nfolds =</span> <span class="dv">5</span>, <span class="dt">parallel =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Next we plot the cross-validated curve:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cvfit_linear)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>And extract the model at <code>lambda.min</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(cvfit_linear, <span class="dt">s =</span> <span class="st">"lambda.min"</span>)
<span class="co">#&gt; 42 x 1 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                       1</span>
<span class="co">#&gt; (Intercept)   5.4385233</span>
<span class="co">#&gt; X1_1          2.4568905</span>
<span class="co">#&gt; X2_1         -1.6516411</span>
<span class="co">#&gt; X3_1         -5.1515618</span>
<span class="co">#&gt; X4_1         -7.1355682</span>
<span class="co">#&gt; X5_1          .        </span>
<span class="co">#&gt; X6_1          .        </span>
<span class="co">#&gt; X7_1         -1.1055226</span>
<span class="co">#&gt; X8_1         -0.8602264</span>
<span class="co">#&gt; X9_1          .        </span>
<span class="co">#&gt; X10_1         .        </span>
<span class="co">#&gt; X11_1        -2.1990113</span>
<span class="co">#&gt; X12_1         .        </span>
<span class="co">#&gt; X13_1         .        </span>
<span class="co">#&gt; X14_1        -1.9208173</span>
<span class="co">#&gt; X15_1         .        </span>
<span class="co">#&gt; X16_1         3.2004658</span>
<span class="co">#&gt; X17_1         .        </span>
<span class="co">#&gt; X18_1         1.0234816</span>
<span class="co">#&gt; X19_1         .        </span>
<span class="co">#&gt; X20_1        -0.2161608</span>
<span class="co">#&gt; E             2.4466054</span>
<span class="co">#&gt; X1_1:E       -4.3993869</span>
<span class="co">#&gt; X2_1:E       -2.7114248</span>
<span class="co">#&gt; X3_1:E       -4.7196594</span>
<span class="co">#&gt; X4_1:E      -12.9774650</span>
<span class="co">#&gt; X5_1:E        .        </span>
<span class="co">#&gt; X6_1:E        .        </span>
<span class="co">#&gt; X7_1:E        2.3703946</span>
<span class="co">#&gt; X8_1:E        .        </span>
<span class="co">#&gt; X9_1:E        .        </span>
<span class="co">#&gt; X10_1:E       .        </span>
<span class="co">#&gt; X11_1:E      -2.1462173</span>
<span class="co">#&gt; X12_1:E       .        </span>
<span class="co">#&gt; X13_1:E       .        </span>
<span class="co">#&gt; X14_1:E      -0.9787678</span>
<span class="co">#&gt; X15_1:E       .        </span>
<span class="co">#&gt; X16_1:E       6.9265731</span>
<span class="co">#&gt; X17_1:E       .        </span>
<span class="co">#&gt; X18_1:E       1.9004167</span>
<span class="co">#&gt; X19_1:E       .        </span>
<span class="co">#&gt; X20_1:E       .</span></code></pre></div>
</div>
<div id="applying-a-different-penalty-to-each-predictor" class="section level2">
<h2 class="hasAnchor">
<a href="#applying-a-different-penalty-to-each-predictor" class="anchor"></a>Applying a different penalty to each predictor</h2>
<p>Recall that we consider the following penalized least squares criterion for this problem:</p>
<span class="math display">\[\begin{equation}
\arg\min_{\boldsymbol{\theta} }  \mathcal{L}(Y;\boldsymbol{\theta}) + \lambda (1-\alpha)  \left( w_E |\beta_E| + \sum_{j=1}^{p} w_j \lVert\boldsymbol{\theta}_j \rVert_2 \right) +  \lambda\alpha \sum_{j=1}^{p} w_{jE} |\gamma_{j}| 
\end{equation}\]</span>
<p>The weights <span class="math inline">\(w_E, w_j, w_{jE}\)</span> are by default set to 1 as specified by the <code>penalty.factor</code> argument. This argument allows users to apply separate penalty factors to each coefficient. In particular, any variable with <code>penalty.factor</code> equal to zero is not penalized at all. This feature can be applied mainly for two reasons:</p>
<ol style="list-style-type: decimal">
<li>Prior knowledge about the importance of certain variables is known. Larger weights will penalize the variable more, while smaller weights will penalize the variable less<br>
</li>
<li>Allows users to apply the Adaptive <code>sail</code>, similar to the <a href="http://users.stat.umn.edu/~zouxx019/Papers/adalasso.pdf">Adaptive Lasso</a>
</li>
</ol>
<p>In the following example, we want the environment variable to always be included so we set the first element of <code>p.fac</code> to zero. We also want to apply less of a penalty to the main effects for <span class="math inline">\(X_2, X_3, X_4\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the weights correspond to E, X1, X2, X3, ... X_p, X1:E, X2:E, ... X_p:E</span>
p.fac &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="op">*</span><span class="kw">ncol</span>(sailsim<span class="op">$</span>x) <span class="op">-</span><span class="st"> </span><span class="dv">4</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_pf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sail.html">sail</a></span>(<span class="dt">x =</span> sailsim<span class="op">$</span>x, <span class="dt">y =</span> sailsim<span class="op">$</span>y, <span class="dt">e =</span> sailsim<span class="op">$</span>e, <span class="dt">basis =</span> f.basis,
               <span class="dt">penalty.factor =</span> p.fac)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fit_pf)</code></pre></div>
<p><img src="introduction-to-sail_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>We see from the plot above that the black line (corresponding to the <span class="math inline">\(E\)</span> variable with <code>penalty.factor</code> equal to zero) is always included in the model.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#model">Model</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#quick-start">Quick Start</a></li>
      <li><a href="#cross-validation">Cross-Validation</a></li>
      <li><a href="#visualizing-the-effect-of-the-non-linear-terms">Visualizing the Effect of the Non-linear Terms</a></li>
      <li><a href="#linear-interactions">Linear Interactions</a></li>
      <li><a href="#applying-a-different-penalty-to-each-predictor">Applying a different penalty to each predictor</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://sahirbhatnagar.com">Sahir Bhatnagar</a>, <a href="http://www.math.mcgill.ca/yyang/">Yi Yang</a>, <a href="https://www.mcgill.ca/statisticalgenetics/">Celia Greenwood</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    apiKey: 'f8a14d62b00c65f3af4a90aa62a286b8',
    indexName: 'sail',
    inputSelector: 'input#search-input.form-control',
    debug: false // Set debug to true if you want to inspect the dropdown
  });
</script>
</body>
</html>
